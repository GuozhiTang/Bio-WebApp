import { InjectionToken, Directive, ElementRef, Inject, Input, PLATFORM_ID, Renderer2, Injectable, Component, Output, EventEmitter, ViewChild, NgZone, ContentChildren, HostBinding, NgModule } from '@angular/core';
import { isPlatformBrowser, CommonModule } from '@angular/common';
import { __values, __read, __spread } from 'tslib';
import { filter, map, withLatestFrom, distinctUntilChanged, switchMap, takeUntil, tap, auditTime, mapTo, share, observeOn, startWith, concatMapTo, first } from 'rxjs/operators';
import { Subject, combineLatest, merge, from, fromEvent, BehaviorSubject, asyncScheduler } from 'rxjs';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
var CONFIG = new InjectionToken('DRAG_TO_SELECT_CONFIG');
/** @type {?} */
var USER_CONFIG = new InjectionToken('USER_CONFIG');

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
var AUDIT_TIME = 16;
/** @type {?} */
var MIN_WIDTH = 5;
/** @type {?} */
var MIN_HEIGHT = 5;
/** @type {?} */
var NO_SELECT_CLASS = 'dts-no-select';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
var isObject = function (item) {
    return item && typeof item === 'object' && !Array.isArray(item) && item !== null;
};
/**
 * @param {?} target
 * @param {?} source
 * @return {?}
 */
function mergeDeep(target, source) {
    if (isObject(target) && isObject(source)) {
        Object.keys(source).forEach(function (key) {
            var _a, _b;
            if (isObject(source[key])) {
                if (!target[key]) {
                    Object.assign(target, (_a = {}, _a[key] = {}, _a));
                }
                mergeDeep(target[key], source[key]);
            }
            else {
                Object.assign(target, (_b = {}, _b[key] = source[key], _b));
            }
        });
    }
    return target;
}
/** @type {?} */
var hasMinimumSize = function (selectBox, minWidth, minHeight) {
    if (minWidth === void 0) { minWidth = MIN_WIDTH; }
    if (minHeight === void 0) { minHeight = MIN_HEIGHT; }
    return selectBox.width > minWidth || selectBox.height > minHeight;
};
/** @type {?} */
var clearSelection = function (window) {
    /** @type {?} */
    var selection = window.getSelection();
    if (selection.removeAllRanges) {
        selection.removeAllRanges();
    }
    else if (selection.empty) {
        selection.empty();
    }
};
/** @type {?} */
var inBoundingBox = function (point, box) {
    return (box.left <= point.x && point.x <= box.left + box.width && box.top <= point.y && point.y <= box.top + box.height);
};
/** @type {?} */
var boxIntersects = function (boxA, boxB) {
    return (boxA.left <= boxB.left + boxB.width &&
        boxA.left + boxA.width >= boxB.left &&
        boxA.top <= boxB.top + boxB.height &&
        boxA.top + boxA.height >= boxB.top);
};
/** @type {?} */
var calculateBoundingClientRect = function (element) {
    return element.getBoundingClientRect();
};
/** @type {?} */
var getMousePosition = function (event) {
    return {
        x: event.clientX,
        y: event.clientY
    };
};
/** @type {?} */
var getScroll = function () {
    if (!document || !document.documentElement) {
        return {
            x: 0,
            y: 0
        };
    }
    return {
        x: document.documentElement.scrollLeft || document.body.scrollLeft,
        y: document.documentElement.scrollTop || document.body.scrollTop
    };
};
/** @type {?} */
var getRelativeMousePosition = function (event, container) {
    var _a = getMousePosition(event), clientX = _a.x, clientY = _a.y;
    /** @type {?} */
    var scroll = getScroll();
    /** @type {?} */
    var borderSize = (container.boundingClientRect.width - container.clientWidth) / 2;
    /** @type {?} */
    var offsetLeft = container.boundingClientRect.left + scroll.x;
    /** @type {?} */
    var offsetTop = container.boundingClientRect.top + scroll.y;
    return {
        x: clientX - borderSize - (offsetLeft - window.pageXOffset) + container.scrollLeft,
        y: clientY - borderSize - (offsetTop - window.pageYOffset) + container.scrollTop
    };
};
/** @type {?} */
var cursorWithinElement = function (event, element) {
    /** @type {?} */
    var mousePoint = getMousePosition(event);
    return inBoundingBox(mousePoint, calculateBoundingClientRect(element));
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
var SelectItemDirective = /** @class */ (function () {
    function SelectItemDirective(config, platformId, host, renderer) {
        this.config = config;
        this.platformId = platformId;
        this.host = host;
        this.renderer = renderer;
        this.selected = false;
    }
    Object.defineProperty(SelectItemDirective.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this.dtsSelectItem ? this.dtsSelectItem : this;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    SelectItemDirective.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        if (isPlatformBrowser(this.platformId)) {
            this.calculateBoundingClientRect();
        }
    };
    /**
     * @return {?}
     */
    SelectItemDirective.prototype.ngDoCheck = /**
     * @return {?}
     */
    function () {
        this.applySelectedClass();
    };
    /**
     * @return {?}
     */
    SelectItemDirective.prototype.getBoundingClientRect = /**
     * @return {?}
     */
    function () {
        return this._boundingClientRect;
    };
    /**
     * @return {?}
     */
    SelectItemDirective.prototype.calculateBoundingClientRect = /**
     * @return {?}
     */
    function () {
        this._boundingClientRect = calculateBoundingClientRect(this.host.nativeElement);
    };
    /**
     * @return {?}
     */
    SelectItemDirective.prototype._select = /**
     * @return {?}
     */
    function () {
        this.selected = true;
    };
    /**
     * @return {?}
     */
    SelectItemDirective.prototype._deselect = /**
     * @return {?}
     */
    function () {
        this.selected = false;
    };
    /**
     * @return {?}
     */
    SelectItemDirective.prototype.applySelectedClass = /**
     * @return {?}
     */
    function () {
        if (this.selected) {
            this.renderer.addClass(this.host.nativeElement, this.config.selectedClass);
        }
        else {
            this.renderer.removeClass(this.host.nativeElement, this.config.selectedClass);
        }
    };
    SelectItemDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[dtsSelectItem]',
                    exportAs: 'dtsSelectItem',
                    host: {
                        class: 'dts-select-item'
                    }
                },] }
    ];
    /** @nocollapse */
    SelectItemDirective.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: Inject, args: [CONFIG,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] },
        { type: ElementRef },
        { type: Renderer2 }
    ]; };
    SelectItemDirective.propDecorators = {
        dtsSelectItem: [{ type: Input }]
    };
    return SelectItemDirective;
}());

var _a;
/** @type {?} */
var SUPPORTED_KEYS = {
    alt: true,
    shift: true,
    meta: true,
    ctrl: true
};
/** @type {?} */
var META_KEY = 'meta';
/** @type {?} */
var KEY_ALIASES = (_a = {},
    _a[META_KEY] = ['ctrl', 'meta'],
    _a);
/** @type {?} */
var SUPPORTED_SHORTCUTS = {
    disableSelection: true,
    toggleSingleItem: true,
    addToSelection: true,
    removeFromSelection: true
};
/** @type {?} */
var ERROR_PREFIX = '[ShortcutService]';
var ShortcutService = /** @class */ (function () {
    function ShortcutService(config) {
        this.config = config;
        this._shortcuts = {};
        this._shortcuts = this.createShortcutsFromConfig(config.shortcuts);
    }
    /**
     * @param {?} event
     * @return {?}
     */
    ShortcutService.prototype.disableSelection = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        return this.isShortcutPressed('disableSelection', event);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ShortcutService.prototype.toggleSingleItem = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        return this.isShortcutPressed('toggleSingleItem', event);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ShortcutService.prototype.addToSelection = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        return this.isShortcutPressed('addToSelection', event);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ShortcutService.prototype.removeFromSelection = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        return this.isShortcutPressed('removeFromSelection', event);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ShortcutService.prototype.extendedSelectionShortcut = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        return this.addToSelection(event) || this.removeFromSelection(event);
    };
    /**
     * @param {?} shortcuts
     * @return {?}
     */
    ShortcutService.prototype.createShortcutsFromConfig = /**
     * @param {?} shortcuts
     * @return {?}
     */
    function (shortcuts) {
        var _this = this;
        var e_1, _a;
        /** @type {?} */
        var shortcutMap = {};
        var _loop_1 = function (key, shortcutsForCommand) {
            if (!this_1.isSupportedShortcut(key)) {
                throw new Error(this_1.getErrorMessage("Shortcut " + key + " not supported"));
            }
            shortcutsForCommand
                .replace(/ /g, '')
                .split(',')
                .forEach(function (shortcut) {
                if (!shortcutMap[key]) {
                    shortcutMap[key] = [];
                }
                /** @type {?} */
                var combo = shortcut.split('+');
                /** @type {?} */
                var cleanCombos = _this.substituteKey(shortcut, combo, META_KEY);
                cleanCombos.forEach(function (cleanCombo) {
                    /** @type {?} */
                    var unsupportedKey = _this.isSupportedCombo(cleanCombo);
                    if (unsupportedKey) {
                        throw new Error(_this.getErrorMessage("Key '" + unsupportedKey + "' in shortcut " + shortcut + " not supported"));
                    }
                    shortcutMap[key].push(cleanCombo.map(function (comboKey) { return comboKey + "Key"; }));
                });
            });
        };
        var this_1 = this;
        try {
            for (var _b = __values(Object.entries(shortcuts)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var _d = __read(_c.value, 2), key = _d[0], shortcutsForCommand = _d[1];
                _loop_1(key, shortcutsForCommand);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return shortcutMap;
    };
    /**
     * @param {?} shortcut
     * @param {?} combo
     * @param {?} substituteKey
     * @return {?}
     */
    ShortcutService.prototype.substituteKey = /**
     * @param {?} shortcut
     * @param {?} combo
     * @param {?} substituteKey
     * @return {?}
     */
    function (shortcut, combo, substituteKey) {
        /** @type {?} */
        var hasSpecialKey = shortcut.includes(substituteKey);
        /** @type {?} */
        var substitutedShortcut = [];
        if (hasSpecialKey) {
            /** @type {?} */
            var cleanShortcut_1 = combo.filter(function (element) { return element !== META_KEY; });
            KEY_ALIASES.meta.forEach(function (alias) {
                substitutedShortcut.push(__spread(cleanShortcut_1, [alias]));
            });
        }
        else {
            substitutedShortcut.push(combo);
        }
        return substitutedShortcut;
    };
    /**
     * @param {?} message
     * @return {?}
     */
    ShortcutService.prototype.getErrorMessage = /**
     * @param {?} message
     * @return {?}
     */
    function (message) {
        return ERROR_PREFIX + " " + message;
    };
    /**
     * @param {?} shortcutName
     * @param {?} event
     * @return {?}
     */
    ShortcutService.prototype.isShortcutPressed = /**
     * @param {?} shortcutName
     * @param {?} event
     * @return {?}
     */
    function (shortcutName, event) {
        /** @type {?} */
        var shortcuts = this._shortcuts[shortcutName];
        return shortcuts.some(function (shortcut) {
            return shortcut.every(function (key) { return event[key]; });
        });
    };
    /**
     * @param {?} combo
     * @return {?}
     */
    ShortcutService.prototype.isSupportedCombo = /**
     * @param {?} combo
     * @return {?}
     */
    function (combo) {
        /** @type {?} */
        var unsupportedKey = null;
        combo.forEach(function (key) {
            if (!SUPPORTED_KEYS[key]) {
                unsupportedKey = key;
                return;
            }
        });
        return unsupportedKey;
    };
    /**
     * @param {?} shortcut
     * @return {?}
     */
    ShortcutService.prototype.isSupportedShortcut = /**
     * @param {?} shortcut
     * @return {?}
     */
    function (shortcut) {
        return SUPPORTED_SHORTCUTS[shortcut];
    };
    ShortcutService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ShortcutService.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: Inject, args: [CONFIG,] }] }
    ]; };
    return ShortcutService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
var createSelectBox = function (container) { return function (source) {
    return source.pipe(map(function (_a) {
        var _b = __read(_a, 3), event = _b[0], opacity = _b[1], _c = _b[2], x = _c.x, y = _c.y;
        // Type annotation is required here, because `getRelativeMousePosition` returns a `MousePosition`,
        // the TS compiler cannot figure out the shape of this type.
        /** @type {?} */
        var mousePosition = getRelativeMousePosition(event, container);
        /** @type {?} */
        var width = opacity > 0 ? mousePosition.x - x : 0;
        /** @type {?} */
        var height = opacity > 0 ? mousePosition.y - y : 0;
        return {
            top: height < 0 ? mousePosition.y : y,
            left: width < 0 ? mousePosition.x : x,
            width: Math.abs(width),
            height: Math.abs(height),
            opacity: opacity
        };
    }));
}; };
/** @type {?} */
var whenSelectBoxVisible = function (selectBox$) { return function (source) {
    return source.pipe(withLatestFrom(selectBox$), filter(function (_a) {
        var _b = __read(_a, 2), selectBox = _b[1];
        return hasMinimumSize(selectBox, 0, 0);
    }), map(function (_a) {
        var _b = __read(_a, 2), event = _b[0], _ = _b[1];
        return event;
    }));
}; };
/** @type {?} */
var distinctKeyEvents = function () { return function (source) {
    return source.pipe(distinctUntilChanged(function (prev, curr) {
        return prev.keyCode === curr.keyCode;
    }));
}; };

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @enum {number} */
var UpdateActions = {
    Add: 0,
    Remove: 1,
};
UpdateActions[UpdateActions.Add] = 'Add';
UpdateActions[UpdateActions.Remove] = 'Remove';
/** @enum {number} */
var Action = {
    Add: 0,
    Delete: 1,
    None: 2,
};
Action[Action.Add] = 'Add';
Action[Action.Delete] = 'Delete';
Action[Action.None] = 'None';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
var SelectContainerComponent = /** @class */ (function () {
    function SelectContainerComponent(platformId, shortcuts, hostElementRef, renderer, ngZone) {
        this.platformId = platformId;
        this.shortcuts = shortcuts;
        this.hostElementRef = hostElementRef;
        this.renderer = renderer;
        this.ngZone = ngZone;
        this.selectOnDrag = true;
        this.disabled = false;
        this.disableDrag = false;
        this.selectMode = false;
        this.selectWithShortcut = false;
        this.custom = false;
        this.selectedItemsChange = new EventEmitter();
        this.select = new EventEmitter();
        this.itemSelected = new EventEmitter();
        this.itemDeselected = new EventEmitter();
        this.selectionStarted = new EventEmitter();
        this.selectionEnded = new EventEmitter();
        this._tmpItems = new Map();
        this._selectedItems$ = new BehaviorSubject([]);
        this.updateItems$ = new Subject();
        this.destroy$ = new Subject();
    }
    /**
     * @return {?}
     */
    SelectContainerComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (isPlatformBrowser(this.platformId)) {
            this.host = this.hostElementRef.nativeElement;
            this._initSelectedItemsChange();
            this._calculateBoundingClientRect();
            this._observeBoundingRectChanges();
            this._observeSelectableItems();
            // distinctKeyEvents is used to prevent multiple key events to be fired repeatedly
            // on Windows when a key is being pressed
            /** @type {?} */
            var keydown$ = fromEvent(window, 'keydown').pipe(distinctKeyEvents(), share());
            /** @type {?} */
            var keyup$ = fromEvent(window, 'keyup').pipe(distinctKeyEvents(), share());
            /** @type {?} */
            var mouseup$_1 = fromEvent(window, 'mouseup').pipe(filter(function () { return !_this.disabled; }), tap(function () { return _this._onMouseUp(); }), share());
            /** @type {?} */
            var mousemove$_1 = fromEvent(window, 'mousemove').pipe(filter(function () { return !_this.disabled; }), share());
            /** @type {?} */
            var mousedown$ = fromEvent(this.host, 'mousedown').pipe(filter(function (event) { return event.button === 0; }), // only emit left mouse
            filter(function () { return !_this.disabled; }), tap(function (event) { return _this._onMouseDown(event); }), share());
            /** @type {?} */
            var dragging$ = mousedown$.pipe(filter(function (event) { return !_this.shortcuts.disableSelection(event); }), filter(function () { return !_this.selectMode; }), filter(function () { return !_this.disableDrag; }), switchMap(function () { return mousemove$_1.pipe(takeUntil(mouseup$_1)); }), share());
            /** @type {?} */
            var currentMousePosition$ = mousedown$.pipe(map(function (event) { return getRelativeMousePosition(event, _this.host); }));
            /** @type {?} */
            var show$ = dragging$.pipe(mapTo(1));
            /** @type {?} */
            var hide$ = mouseup$_1.pipe(mapTo(0));
            /** @type {?} */
            var opacity$ = merge(show$, hide$).pipe(distinctUntilChanged());
            /** @type {?} */
            var selectBox$ = combineLatest(dragging$, opacity$, currentMousePosition$).pipe(createSelectBox(this.host), share());
            this.selectBoxClasses$ = merge(dragging$, mouseup$_1, keydown$, keyup$).pipe(auditTime(AUDIT_TIME), withLatestFrom(selectBox$), map(function (_a) {
                var _b = __read(_a, 2), event = _b[0], selectBox = _b[1];
                return {
                    'dts-adding': hasMinimumSize(selectBox, 0, 0) && !_this.shortcuts.removeFromSelection(event),
                    'dts-removing': _this.shortcuts.removeFromSelection(event)
                };
            }), distinctUntilChanged(function (a, b) { return JSON.stringify(a) === JSON.stringify(b); }));
            /** @type {?} */
            var selectOnMouseUp$ = dragging$.pipe(filter(function () { return !_this.selectOnDrag; }), filter(function () { return !_this.selectMode; }), filter(function (event) { return _this._cursorWithinHost(event); }), switchMap(function (_) { return mouseup$_1.pipe(first()); }), filter(function (event) {
                return (!_this.shortcuts.disableSelection(event) && !_this.shortcuts.toggleSingleItem(event)) ||
                    _this.shortcuts.removeFromSelection(event);
            }));
            /** @type {?} */
            var selectOnDrag$ = selectBox$.pipe(auditTime(AUDIT_TIME), withLatestFrom(mousemove$_1, function (selectBox, event) { return ({
                selectBox: selectBox,
                event: event
            }); }), filter(function () { return _this.selectOnDrag; }), filter(function (_a) {
                var selectBox = _a.selectBox;
                return hasMinimumSize(selectBox);
            }), map(function (_a) {
                var event = _a.event;
                return event;
            }));
            /** @type {?} */
            var selectOnKeyboardEvent$ = merge(keydown$, keyup$).pipe(auditTime(AUDIT_TIME), whenSelectBoxVisible(selectBox$), tap(function (event) {
                if (_this._isExtendedSelection(event)) {
                    _this._tmpItems.clear();
                }
                else {
                    _this._flushItems();
                }
            }));
            merge(selectOnMouseUp$, selectOnDrag$, selectOnKeyboardEvent$)
                .pipe(takeUntil(this.destroy$))
                .subscribe(function (event) { return _this._selectItems(event); });
            this.selectBoxStyles$ = selectBox$.pipe(map(function (selectBox) { return ({
                top: selectBox.top + "px",
                left: selectBox.left + "px",
                width: selectBox.width + "px",
                height: selectBox.height + "px",
                opacity: selectBox.opacity
            }); }));
            this._initSelectionOutputs(mousedown$, mouseup$_1);
        }
    };
    /**
     * @return {?}
     */
    SelectContainerComponent.prototype.selectAll = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.$selectableItems.forEach(function (item) {
            _this._selectItem(item);
        });
    };
    /**
     * @template T
     * @param {?} predicate
     * @return {?}
     */
    SelectContainerComponent.prototype.toggleItems = /**
     * @template T
     * @param {?} predicate
     * @return {?}
     */
    function (predicate) {
        var _this = this;
        this._filterSelectableItems(predicate).subscribe(function (item) { return _this._toggleItem(item); });
    };
    /**
     * @template T
     * @param {?} predicate
     * @return {?}
     */
    SelectContainerComponent.prototype.selectItems = /**
     * @template T
     * @param {?} predicate
     * @return {?}
     */
    function (predicate) {
        var _this = this;
        this._filterSelectableItems(predicate).subscribe(function (item) { return _this._selectItem(item); });
    };
    /**
     * @template T
     * @param {?} predicate
     * @return {?}
     */
    SelectContainerComponent.prototype.deselectItems = /**
     * @template T
     * @param {?} predicate
     * @return {?}
     */
    function (predicate) {
        var _this = this;
        this._filterSelectableItems(predicate).subscribe(function (item) { return _this._deselectItem(item); });
    };
    /**
     * @return {?}
     */
    SelectContainerComponent.prototype.clearSelection = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.$selectableItems.forEach(function (item) {
            _this._deselectItem(item);
        });
    };
    /**
     * @return {?}
     */
    SelectContainerComponent.prototype.update = /**
     * @return {?}
     */
    function () {
        this._calculateBoundingClientRect();
        this.$selectableItems.forEach(function (item) { return item.calculateBoundingClientRect(); });
    };
    /**
     * @return {?}
     */
    SelectContainerComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.destroy$.next();
        this.destroy$.complete();
    };
    /**
     * @template T
     * @param {?} predicate
     * @return {?}
     */
    SelectContainerComponent.prototype._filterSelectableItems = /**
     * @template T
     * @param {?} predicate
     * @return {?}
     */
    function (predicate) {
        // Wrap select items in an observable for better efficiency as
        // no intermediate arrays are created and we only need to process
        // every item once.
        return from(this.$selectableItems.toArray()).pipe(filter(function (item) { return predicate(item.value); }));
    };
    /**
     * @return {?}
     */
    SelectContainerComponent.prototype._initSelectedItemsChange = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this._selectedItems$
            .pipe(auditTime(AUDIT_TIME), takeUntil(this.destroy$))
            .subscribe({
            next: function (selectedItems) {
                _this.selectedItemsChange.emit(selectedItems);
                _this.select.emit(selectedItems);
            },
            complete: function () {
                _this.selectedItemsChange.emit([]);
            }
        });
    };
    /**
     * @return {?}
     */
    SelectContainerComponent.prototype._observeSelectableItems = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // Listen for updates and either select or deselect an item
        this.updateItems$
            .pipe(withLatestFrom(this._selectedItems$), takeUntil(this.destroy$))
            .subscribe(function (_a) {
            var _b = __read(_a, 2), update = _b[0], selectedItems = _b[1];
            /** @type {?} */
            var item = update.item;
            switch (update.type) {
                case UpdateActions.Add:
                    if (_this._addItem(item, selectedItems)) {
                        item._select();
                    }
                    break;
                case UpdateActions.Remove:
                    if (_this._removeItem(item, selectedItems)) {
                        item._deselect();
                    }
                    break;
            }
        });
        // Update the container as well as all selectable items if the list has changed
        this.$selectableItems.changes
            .pipe(withLatestFrom(this._selectedItems$), observeOn(asyncScheduler), takeUntil(this.destroy$))
            .subscribe(function (_a) {
            var _b = __read(_a, 2), items = _b[0], selectedItems = _b[1];
            /** @type {?} */
            var newList = items.toArray();
            /** @type {?} */
            var removedItems = selectedItems.filter(function (item) { return !newList.includes(item.value); });
            if (removedItems.length) {
                removedItems.forEach(function (item) { return _this._removeItem(item, selectedItems); });
            }
            _this.update();
        });
    };
    /**
     * @return {?}
     */
    SelectContainerComponent.prototype._observeBoundingRectChanges = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ngZone.runOutsideAngular(function () {
            /** @type {?} */
            var resize$ = fromEvent(window, 'resize');
            /** @type {?} */
            var windowScroll$ = fromEvent(window, 'scroll');
            /** @type {?} */
            var containerScroll$ = fromEvent(_this.host, 'scroll');
            merge(resize$, windowScroll$, containerScroll$)
                .pipe(startWith('INITIAL_UPDATE'), auditTime(AUDIT_TIME), takeUntil(_this.destroy$))
                .subscribe(function () {
                _this.update();
            });
        });
    };
    /**
     * @param {?} mousedown$
     * @param {?} mouseup$
     * @return {?}
     */
    SelectContainerComponent.prototype._initSelectionOutputs = /**
     * @param {?} mousedown$
     * @param {?} mouseup$
     * @return {?}
     */
    function (mousedown$, mouseup$) {
        var _this = this;
        mousedown$
            .pipe(filter(function (event) { return _this._cursorWithinHost(event); }), tap(function () { return _this.selectionStarted.emit(); }), concatMapTo(mouseup$.pipe(first())), withLatestFrom(this._selectedItems$), map(function (_a) {
            var _b = __read(_a, 2), items = _b[1];
            return items;
        }), takeUntil(this.destroy$))
            .subscribe(function (items) {
            _this.selectionEnded.emit(items);
        });
    };
    /**
     * @return {?}
     */
    SelectContainerComponent.prototype._calculateBoundingClientRect = /**
     * @return {?}
     */
    function () {
        this.host.boundingClientRect = calculateBoundingClientRect(this.host);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SelectContainerComponent.prototype._cursorWithinHost = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        return cursorWithinElement(event, this.host);
    };
    /**
     * @return {?}
     */
    SelectContainerComponent.prototype._onMouseUp = /**
     * @return {?}
     */
    function () {
        this._flushItems();
        this.renderer.removeClass(document.body, NO_SELECT_CLASS);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SelectContainerComponent.prototype._onMouseDown = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        if (this.shortcuts.disableSelection(event) || this.disabled) {
            return;
        }
        clearSelection(window);
        if (!this.disableDrag) {
            this.renderer.addClass(document.body, NO_SELECT_CLASS);
        }
        /** @type {?} */
        var mousePoint = getMousePosition(event);
        this.$selectableItems.forEach(function (item, index) {
            /** @type {?} */
            var itemRect = item.getBoundingClientRect();
            /** @type {?} */
            var withinBoundingBox = inBoundingBox(mousePoint, itemRect);
            if (_this.shortcuts.extendedSelectionShortcut(event)) {
                return;
            }
            /** @type {?} */
            var shouldAdd = (withinBoundingBox &&
                !_this.shortcuts.toggleSingleItem(event) &&
                !_this.selectMode &&
                !_this.selectWithShortcut) ||
                (withinBoundingBox && _this.shortcuts.toggleSingleItem(event) && !item.selected) ||
                (!withinBoundingBox && _this.shortcuts.toggleSingleItem(event) && item.selected) ||
                (withinBoundingBox && !item.selected && _this.selectMode) ||
                (!withinBoundingBox && item.selected && _this.selectMode);
            /** @type {?} */
            var shouldRemove = (!withinBoundingBox &&
                !_this.shortcuts.toggleSingleItem(event) &&
                !_this.selectMode &&
                !_this.selectWithShortcut) ||
                (!withinBoundingBox && _this.shortcuts.toggleSingleItem(event) && !item.selected) ||
                (withinBoundingBox && _this.shortcuts.toggleSingleItem(event) && item.selected) ||
                (!withinBoundingBox && !item.selected && _this.selectMode) ||
                (withinBoundingBox && item.selected && _this.selectMode);
            if (shouldAdd) {
                _this._selectItem(item);
            }
            else if (shouldRemove) {
                _this._deselectItem(item);
            }
        });
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SelectContainerComponent.prototype._selectItems = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        /** @type {?} */
        var selectionBox = calculateBoundingClientRect(this.$selectBox.nativeElement);
        this.$selectableItems.forEach(function (item) {
            if (_this._isExtendedSelection(event)) {
                _this._extendedSelectionMode(selectionBox, item, event);
            }
            else {
                _this._normalSelectionMode(selectionBox, item, event);
            }
        });
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SelectContainerComponent.prototype._isExtendedSelection = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        return this.shortcuts.extendedSelectionShortcut(event) && this.selectOnDrag;
    };
    /**
     * @param {?} selectBox
     * @param {?} item
     * @param {?} event
     * @return {?}
     */
    SelectContainerComponent.prototype._normalSelectionMode = /**
     * @param {?} selectBox
     * @param {?} item
     * @param {?} event
     * @return {?}
     */
    function (selectBox, item, event) {
        /** @type {?} */
        var inSelection = boxIntersects(selectBox, item.getBoundingClientRect());
        /** @type {?} */
        var shouldAdd = inSelection && !item.selected && !this.shortcuts.removeFromSelection(event);
        /** @type {?} */
        var shouldRemove = (!inSelection && item.selected && !this.shortcuts.addToSelection(event)) ||
            (inSelection && item.selected && this.shortcuts.removeFromSelection(event));
        if (shouldAdd) {
            this._selectItem(item);
        }
        else if (shouldRemove) {
            this._deselectItem(item);
        }
    };
    /**
     * @param {?} selectBox
     * @param {?} item
     * @param {?} event
     * @return {?}
     */
    SelectContainerComponent.prototype._extendedSelectionMode = /**
     * @param {?} selectBox
     * @param {?} item
     * @param {?} event
     * @return {?}
     */
    function (selectBox, item, event) {
        /** @type {?} */
        var inSelection = boxIntersects(selectBox, item.getBoundingClientRect());
        /** @type {?} */
        var shoudlAdd = (inSelection && !item.selected && !this.shortcuts.removeFromSelection(event) && !this._tmpItems.has(item)) ||
            (inSelection && item.selected && this.shortcuts.removeFromSelection(event) && !this._tmpItems.has(item));
        /** @type {?} */
        var shouldRemove = (!inSelection && item.selected && this.shortcuts.addToSelection(event) && this._tmpItems.has(item)) ||
            (!inSelection && !item.selected && this.shortcuts.removeFromSelection(event) && this._tmpItems.has(item));
        if (shoudlAdd) {
            item.selected ? item._deselect() : item._select();
            /** @type {?} */
            var action = this.shortcuts.removeFromSelection(event)
                ? Action.Delete
                : this.shortcuts.addToSelection(event)
                    ? Action.Add
                    : Action.None;
            this._tmpItems.set(item, action);
        }
        else if (shouldRemove) {
            this.shortcuts.removeFromSelection(event) ? item._select() : item._deselect();
            this._tmpItems.delete(item);
        }
    };
    /**
     * @return {?}
     */
    SelectContainerComponent.prototype._flushItems = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this._tmpItems.forEach(function (action, item) {
            if (action === Action.Add) {
                _this._selectItem(item);
            }
            if (action === Action.Delete) {
                _this._deselectItem(item);
            }
        });
        this._tmpItems.clear();
    };
    /**
     * @param {?} item
     * @param {?} selectedItems
     * @return {?}
     */
    SelectContainerComponent.prototype._addItem = /**
     * @param {?} item
     * @param {?} selectedItems
     * @return {?}
     */
    function (item, selectedItems) {
        /** @type {?} */
        var success = false;
        if (!this._hasItem(item, selectedItems)) {
            success = true;
            selectedItems.push(item.value);
            this._selectedItems$.next(selectedItems);
            this.itemSelected.emit(item.value);
        }
        return success;
    };
    /**
     * @param {?} item
     * @param {?} selectedItems
     * @return {?}
     */
    SelectContainerComponent.prototype._removeItem = /**
     * @param {?} item
     * @param {?} selectedItems
     * @return {?}
     */
    function (item, selectedItems) {
        /** @type {?} */
        var success = false;
        /** @type {?} */
        var value = item instanceof SelectItemDirective ? item.value : item;
        /** @type {?} */
        var index = selectedItems.indexOf(value);
        if (index > -1) {
            success = true;
            selectedItems.splice(index, 1);
            this._selectedItems$.next(selectedItems);
            this.itemDeselected.emit(item.value);
        }
        return success;
    };
    /**
     * @param {?} item
     * @return {?}
     */
    SelectContainerComponent.prototype._toggleItem = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        if (item.selected) {
            this._deselectItem(item);
        }
        else {
            this._selectItem(item);
        }
    };
    /**
     * @param {?} item
     * @return {?}
     */
    SelectContainerComponent.prototype._selectItem = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        this.updateItems$.next({ type: UpdateActions.Add, item: item });
    };
    /**
     * @param {?} item
     * @return {?}
     */
    SelectContainerComponent.prototype._deselectItem = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        this.updateItems$.next({ type: UpdateActions.Remove, item: item });
    };
    /**
     * @param {?} item
     * @param {?} selectedItems
     * @return {?}
     */
    SelectContainerComponent.prototype._hasItem = /**
     * @param {?} item
     * @param {?} selectedItems
     * @return {?}
     */
    function (item, selectedItems) {
        return selectedItems.includes(item.value);
    };
    SelectContainerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'dts-select-container',
                    exportAs: 'dts-select-container',
                    host: {
                        class: 'dts-select-container'
                    },
                    template: "\n    <ng-content></ng-content>\n    <div\n      class=\"dts-select-box\"\n      #selectBox\n      [ngClass]=\"selectBoxClasses$ | async\"\n      [ngStyle]=\"selectBoxStyles$ | async\"\n    ></div>\n  ",
                    styles: [":host{display:block;position:relative}"]
                }] }
    ];
    /** @nocollapse */
    SelectContainerComponent.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] },
        { type: ShortcutService },
        { type: ElementRef },
        { type: Renderer2 },
        { type: NgZone }
    ]; };
    SelectContainerComponent.propDecorators = {
        $selectBox: [{ type: ViewChild, args: ['selectBox',] }],
        $selectableItems: [{ type: ContentChildren, args: [SelectItemDirective, { descendants: true },] }],
        selectedItems: [{ type: Input }],
        selectOnDrag: [{ type: Input }],
        disabled: [{ type: Input }],
        disableDrag: [{ type: Input }],
        selectMode: [{ type: Input }],
        selectWithShortcut: [{ type: Input }],
        custom: [{ type: Input }, { type: HostBinding, args: ['class.dts-custom',] }],
        selectedItemsChange: [{ type: Output }],
        select: [{ type: Output }],
        itemSelected: [{ type: Output }],
        itemDeselected: [{ type: Output }],
        selectionStarted: [{ type: Output }],
        selectionEnded: [{ type: Output }]
    };
    return SelectContainerComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
var DEFAULT_CONFIG = {
    selectedClass: 'selected',
    shortcuts: {
        disableSelection: 'alt',
        toggleSingleItem: 'meta',
        addToSelection: 'shift',
        removeFromSelection: 'shift+meta'
    }
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
var COMPONENTS = [SelectContainerComponent, SelectItemDirective];
/**
 * @param {?} config
 * @return {?}
 */
function CONFIG_FACTORY(config) {
    return mergeDeep(DEFAULT_CONFIG, config);
}
var DragToSelectModule = /** @class */ (function () {
    function DragToSelectModule() {
    }
    /**
     * @param {?=} config
     * @return {?}
     */
    DragToSelectModule.forRoot = /**
     * @param {?=} config
     * @return {?}
     */
    function (config) {
        if (config === void 0) { config = {}; }
        return {
            ngModule: DragToSelectModule,
            providers: [
                ShortcutService,
                { provide: USER_CONFIG, useValue: config },
                {
                    provide: CONFIG,
                    useFactory: CONFIG_FACTORY,
                    deps: [USER_CONFIG]
                }
            ]
        };
    };
    DragToSelectModule.decorators = [
        { type: NgModule, args: [{
                    imports: [CommonModule],
                    declarations: __spread(COMPONENTS),
                    exports: __spread(COMPONENTS)
                },] }
    ];
    return DragToSelectModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */

export { CONFIG_FACTORY, DragToSelectModule, SelectContainerComponent, SelectItemDirective, DEFAULT_CONFIG as ɵb, ShortcutService as ɵf, CONFIG as ɵc, USER_CONFIG as ɵd, mergeDeep as ɵa };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWRyYWctdG8tc2VsZWN0LmpzLm1hcCIsInNvdXJjZXMiOlsibmc6Ly9uZ3gtZHJhZy10by1zZWxlY3QvbGliL3Rva2Vucy50cyIsIm5nOi8vbmd4LWRyYWctdG8tc2VsZWN0L2xpYi9jb25zdGFudHMudHMiLCJuZzovL25neC1kcmFnLXRvLXNlbGVjdC9saWIvdXRpbHMudHMiLCJuZzovL25neC1kcmFnLXRvLXNlbGVjdC9saWIvc2VsZWN0LWl0ZW0uZGlyZWN0aXZlLnRzIiwibmc6Ly9uZ3gtZHJhZy10by1zZWxlY3QvbGliL3Nob3J0Y3V0LnNlcnZpY2UudHMiLCJuZzovL25neC1kcmFnLXRvLXNlbGVjdC9saWIvb3BlcmF0b3JzLnRzIiwibmc6Ly9uZ3gtZHJhZy10by1zZWxlY3QvbGliL21vZGVscy50cyIsIm5nOi8vbmd4LWRyYWctdG8tc2VsZWN0L2xpYi9zZWxlY3QtY29udGFpbmVyLmNvbXBvbmVudC50cyIsIm5nOi8vbmd4LWRyYWctdG8tc2VsZWN0L2xpYi9jb25maWcudHMiLCJuZzovL25neC1kcmFnLXRvLXNlbGVjdC9saWIvZHJhZy10by1zZWxlY3QubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGlvblRva2VuIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBEcmFnVG9TZWxlY3RDb25maWcgfSBmcm9tICcuL21vZGVscyc7XG5cbmV4cG9ydCBjb25zdCBDT05GSUcgPSBuZXcgSW5qZWN0aW9uVG9rZW48RHJhZ1RvU2VsZWN0Q29uZmlnPignRFJBR19UT19TRUxFQ1RfQ09ORklHJyk7XG5leHBvcnQgY29uc3QgVVNFUl9DT05GSUcgPSBuZXcgSW5qZWN0aW9uVG9rZW48RHJhZ1RvU2VsZWN0Q29uZmlnPignVVNFUl9DT05GSUcnKTtcbiIsImV4cG9ydCBjb25zdCBBVURJVF9USU1FID0gMTY7XG5leHBvcnQgY29uc3QgTUlOX1dJRFRIID0gNTtcbmV4cG9ydCBjb25zdCBNSU5fSEVJR0hUID0gNTtcbmV4cG9ydCBjb25zdCBOT19TRUxFQ1RfQ0xBU1MgPSAnZHRzLW5vLXNlbGVjdCc7XG4iLCJpbXBvcnQgeyBNSU5fSEVJR0hULCBNSU5fV0lEVEggfSBmcm9tICcuL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBCb3VuZGluZ0JveCwgTW91c2VQb3NpdGlvbiwgU2VsZWN0Qm94LCBTZWxlY3RDb250YWluZXJIb3N0IH0gZnJvbSAnLi9tb2RlbHMnO1xuXG5leHBvcnQgY29uc3QgaXNPYmplY3QgPSAoaXRlbTogYW55KSA9PiB7XG4gIHJldHVybiBpdGVtICYmIHR5cGVvZiBpdGVtID09PSAnb2JqZWN0JyAmJiAhQXJyYXkuaXNBcnJheShpdGVtKSAmJiBpdGVtICE9PSBudWxsO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlRGVlcCh0YXJnZXQ6IE9iamVjdCwgc291cmNlOiBPYmplY3QpIHtcbiAgaWYgKGlzT2JqZWN0KHRhcmdldCkgJiYgaXNPYmplY3Qoc291cmNlKSkge1xuICAgIE9iamVjdC5rZXlzKHNvdXJjZSkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgaWYgKGlzT2JqZWN0KHNvdXJjZVtrZXldKSkge1xuICAgICAgICBpZiAoIXRhcmdldFtrZXldKSB7XG4gICAgICAgICAgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHsgW2tleV06IHt9IH0pO1xuICAgICAgICB9XG4gICAgICAgIG1lcmdlRGVlcCh0YXJnZXRba2V5XSwgc291cmNlW2tleV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHsgW2tleV06IHNvdXJjZVtrZXldIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuZXhwb3J0IGNvbnN0IGhhc01pbmltdW1TaXplID0gKHNlbGVjdEJveDogU2VsZWN0Qm94PG51bWJlcj4sIG1pbldpZHRoID0gTUlOX1dJRFRILCBtaW5IZWlnaHQgPSBNSU5fSEVJR0hUKSA9PiB7XG4gIHJldHVybiBzZWxlY3RCb3gud2lkdGggPiBtaW5XaWR0aCB8fCBzZWxlY3RCb3guaGVpZ2h0ID4gbWluSGVpZ2h0O1xufTtcblxuZXhwb3J0IGNvbnN0IGNsZWFyU2VsZWN0aW9uID0gKHdpbmRvdzogV2luZG93KSA9PiB7XG4gIGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcblxuICBpZiAoc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcykge1xuICAgIHNlbGVjdGlvbi5yZW1vdmVBbGxSYW5nZXMoKTtcbiAgfSBlbHNlIGlmIChzZWxlY3Rpb24uZW1wdHkpIHtcbiAgICBzZWxlY3Rpb24uZW1wdHkoKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGluQm91bmRpbmdCb3ggPSAocG9pbnQ6IE1vdXNlUG9zaXRpb24sIGJveDogQm91bmRpbmdCb3gpID0+IHtcbiAgcmV0dXJuIChcbiAgICBib3gubGVmdCA8PSBwb2ludC54ICYmIHBvaW50LnggPD0gYm94LmxlZnQgKyBib3gud2lkdGggJiYgYm94LnRvcCA8PSBwb2ludC55ICYmIHBvaW50LnkgPD0gYm94LnRvcCArIGJveC5oZWlnaHRcbiAgKTtcbn07XG5cbmV4cG9ydCBjb25zdCBib3hJbnRlcnNlY3RzID0gKGJveEE6IEJvdW5kaW5nQm94LCBib3hCOiBCb3VuZGluZ0JveCkgPT4ge1xuICByZXR1cm4gKFxuICAgIGJveEEubGVmdCA8PSBib3hCLmxlZnQgKyBib3hCLndpZHRoICYmXG4gICAgYm94QS5sZWZ0ICsgYm94QS53aWR0aCA+PSBib3hCLmxlZnQgJiZcbiAgICBib3hBLnRvcCA8PSBib3hCLnRvcCArIGJveEIuaGVpZ2h0ICYmXG4gICAgYm94QS50b3AgKyBib3hBLmhlaWdodCA+PSBib3hCLnRvcFxuICApO1xufTtcblxuZXhwb3J0IGNvbnN0IGNhbGN1bGF0ZUJvdW5kaW5nQ2xpZW50UmVjdCA9IChlbGVtZW50OiBIVE1MRWxlbWVudCk6IEJvdW5kaW5nQm94ID0+IHtcbiAgcmV0dXJuIGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0TW91c2VQb3NpdGlvbiA9IChldmVudDogTW91c2VFdmVudCkgPT4ge1xuICByZXR1cm4ge1xuICAgIHg6IGV2ZW50LmNsaWVudFgsXG4gICAgeTogZXZlbnQuY2xpZW50WVxuICB9O1xufTtcblxuZXhwb3J0IGNvbnN0IGdldFNjcm9sbCA9ICgpID0+IHtcbiAgaWYgKCFkb2N1bWVudCB8fCAhZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHg6IDAsXG4gICAgICB5OiAwXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgeDogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0LFxuICAgIHk6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3BcbiAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRSZWxhdGl2ZU1vdXNlUG9zaXRpb24gPSAoZXZlbnQ6IE1vdXNlRXZlbnQsIGNvbnRhaW5lcjogU2VsZWN0Q29udGFpbmVySG9zdCk6IE1vdXNlUG9zaXRpb24gPT4ge1xuICBjb25zdCB7IHg6IGNsaWVudFgsIHk6IGNsaWVudFkgfSA9IGdldE1vdXNlUG9zaXRpb24oZXZlbnQpO1xuICBjb25zdCBzY3JvbGwgPSBnZXRTY3JvbGwoKTtcblxuICBjb25zdCBib3JkZXJTaXplID0gKGNvbnRhaW5lci5ib3VuZGluZ0NsaWVudFJlY3Qud2lkdGggLSBjb250YWluZXIuY2xpZW50V2lkdGgpIC8gMjtcbiAgY29uc3Qgb2Zmc2V0TGVmdCA9IGNvbnRhaW5lci5ib3VuZGluZ0NsaWVudFJlY3QubGVmdCArIHNjcm9sbC54O1xuICBjb25zdCBvZmZzZXRUb3AgPSBjb250YWluZXIuYm91bmRpbmdDbGllbnRSZWN0LnRvcCArIHNjcm9sbC55O1xuXG4gIHJldHVybiB7XG4gICAgeDogY2xpZW50WCAtIGJvcmRlclNpemUgLSAob2Zmc2V0TGVmdCAtIHdpbmRvdy5wYWdlWE9mZnNldCkgKyBjb250YWluZXIuc2Nyb2xsTGVmdCxcbiAgICB5OiBjbGllbnRZIC0gYm9yZGVyU2l6ZSAtIChvZmZzZXRUb3AgLSB3aW5kb3cucGFnZVlPZmZzZXQpICsgY29udGFpbmVyLnNjcm9sbFRvcFxuICB9O1xufTtcblxuZXhwb3J0IGNvbnN0IGN1cnNvcldpdGhpbkVsZW1lbnQgPSAoZXZlbnQ6IE1vdXNlRXZlbnQsIGVsZW1lbnQ6IEhUTUxFbGVtZW50KSA9PiB7XG4gIGNvbnN0IG1vdXNlUG9pbnQgPSBnZXRNb3VzZVBvc2l0aW9uKGV2ZW50KTtcbiAgcmV0dXJuIGluQm91bmRpbmdCb3gobW91c2VQb2ludCwgY2FsY3VsYXRlQm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnQpKTtcbn07XG4iLCJpbXBvcnQgeyBpc1BsYXRmb3JtQnJvd3NlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5cbmltcG9ydCB7XG4gIERpcmVjdGl2ZSxcbiAgRG9DaGVjayxcbiAgRWxlbWVudFJlZixcbiAgRXZlbnRFbWl0dGVyLFxuICBJbmplY3QsXG4gIElucHV0LFxuICBPbkluaXQsXG4gIE91dHB1dCxcbiAgUExBVEZPUk1fSUQsXG4gIFJlbmRlcmVyMlxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgRHJhZ1RvU2VsZWN0Q29uZmlnIH0gZnJvbSAnLi9tb2RlbHMnO1xuaW1wb3J0IHsgQ09ORklHIH0gZnJvbSAnLi90b2tlbnMnO1xuaW1wb3J0IHsgY2FsY3VsYXRlQm91bmRpbmdDbGllbnRSZWN0IH0gZnJvbSAnLi91dGlscyc7XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ1tkdHNTZWxlY3RJdGVtXScsXG4gIGV4cG9ydEFzOiAnZHRzU2VsZWN0SXRlbScsXG4gIGhvc3Q6IHtcbiAgICBjbGFzczogJ2R0cy1zZWxlY3QtaXRlbSdcbiAgfVxufSlcbmV4cG9ydCBjbGFzcyBTZWxlY3RJdGVtRGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBEb0NoZWNrIHtcbiAgcHJpdmF0ZSBfYm91bmRpbmdDbGllbnRSZWN0O1xuXG4gIHNlbGVjdGVkID0gZmFsc2U7XG5cbiAgQElucHV0KClcbiAgZHRzU2VsZWN0SXRlbTtcblxuICBnZXQgdmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZHRzU2VsZWN0SXRlbSA/IHRoaXMuZHRzU2VsZWN0SXRlbSA6IHRoaXM7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihcbiAgICBASW5qZWN0KENPTkZJRykgcHJpdmF0ZSBjb25maWc6IERyYWdUb1NlbGVjdENvbmZpZyxcbiAgICBASW5qZWN0KFBMQVRGT1JNX0lEKSBwcml2YXRlIHBsYXRmb3JtSWQsXG4gICAgcHJpdmF0ZSBob3N0OiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMlxuICApIHt9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcbiAgICAgIHRoaXMuY2FsY3VsYXRlQm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgfVxuICB9XG5cbiAgbmdEb0NoZWNrKCkge1xuICAgIHRoaXMuYXBwbHlTZWxlY3RlZENsYXNzKCk7XG4gIH1cblxuICBnZXRCb3VuZGluZ0NsaWVudFJlY3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2JvdW5kaW5nQ2xpZW50UmVjdDtcbiAgfVxuXG4gIGNhbGN1bGF0ZUJvdW5kaW5nQ2xpZW50UmVjdCgpIHtcbiAgICB0aGlzLl9ib3VuZGluZ0NsaWVudFJlY3QgPSBjYWxjdWxhdGVCb3VuZGluZ0NsaWVudFJlY3QodGhpcy5ob3N0Lm5hdGl2ZUVsZW1lbnQpO1xuICB9XG5cbiAgX3NlbGVjdCgpIHtcbiAgICB0aGlzLnNlbGVjdGVkID0gdHJ1ZTtcbiAgfVxuXG4gIF9kZXNlbGVjdCgpIHtcbiAgICB0aGlzLnNlbGVjdGVkID0gZmFsc2U7XG4gIH1cblxuICBwcml2YXRlIGFwcGx5U2VsZWN0ZWRDbGFzcygpIHtcbiAgICBpZiAodGhpcy5zZWxlY3RlZCkge1xuICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmhvc3QubmF0aXZlRWxlbWVudCwgdGhpcy5jb25maWcuc2VsZWN0ZWRDbGFzcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy5ob3N0Lm5hdGl2ZUVsZW1lbnQsIHRoaXMuY29uZmlnLnNlbGVjdGVkQ2xhc3MpO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHsgSW5qZWN0YWJsZSwgSW5qZWN0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBEcmFnVG9TZWxlY3RDb25maWcgfSBmcm9tICcuL21vZGVscyc7XG5pbXBvcnQgeyBDT05GSUcgfSBmcm9tICcuL3Rva2Vucyc7XG5cbmNvbnN0IFNVUFBPUlRFRF9LRVlTID0ge1xuICBhbHQ6IHRydWUsXG4gIHNoaWZ0OiB0cnVlLFxuICBtZXRhOiB0cnVlLFxuICBjdHJsOiB0cnVlXG59O1xuXG5jb25zdCBNRVRBX0tFWSA9ICdtZXRhJztcblxuY29uc3QgS0VZX0FMSUFTRVMgPSB7XG4gIFtNRVRBX0tFWV06IFsnY3RybCcsICdtZXRhJ11cbn07XG5cbmNvbnN0IFNVUFBPUlRFRF9TSE9SVENVVFMgPSB7XG4gIGRpc2FibGVTZWxlY3Rpb246IHRydWUsXG4gIHRvZ2dsZVNpbmdsZUl0ZW06IHRydWUsXG4gIGFkZFRvU2VsZWN0aW9uOiB0cnVlLFxuICByZW1vdmVGcm9tU2VsZWN0aW9uOiB0cnVlXG59O1xuXG5jb25zdCBFUlJPUl9QUkVGSVggPSAnW1Nob3J0Y3V0U2VydmljZV0nO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgU2hvcnRjdXRTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBfc2hvcnRjdXRzOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZ1tdW10gfSA9IHt9O1xuXG4gIGNvbnN0cnVjdG9yKEBJbmplY3QoQ09ORklHKSBwcml2YXRlIGNvbmZpZzogRHJhZ1RvU2VsZWN0Q29uZmlnKSB7XG4gICAgdGhpcy5fc2hvcnRjdXRzID0gdGhpcy5jcmVhdGVTaG9ydGN1dHNGcm9tQ29uZmlnKGNvbmZpZy5zaG9ydGN1dHMpO1xuICB9XG5cbiAgZGlzYWJsZVNlbGVjdGlvbihldmVudDogRXZlbnQpIHtcbiAgICByZXR1cm4gdGhpcy5pc1Nob3J0Y3V0UHJlc3NlZCgnZGlzYWJsZVNlbGVjdGlvbicsIGV2ZW50KTtcbiAgfVxuXG4gIHRvZ2dsZVNpbmdsZUl0ZW0oZXZlbnQ6IEV2ZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuaXNTaG9ydGN1dFByZXNzZWQoJ3RvZ2dsZVNpbmdsZUl0ZW0nLCBldmVudCk7XG4gIH1cblxuICBhZGRUb1NlbGVjdGlvbihldmVudDogRXZlbnQpIHtcbiAgICByZXR1cm4gdGhpcy5pc1Nob3J0Y3V0UHJlc3NlZCgnYWRkVG9TZWxlY3Rpb24nLCBldmVudCk7XG4gIH1cblxuICByZW1vdmVGcm9tU2VsZWN0aW9uKGV2ZW50OiBFdmVudCkge1xuICAgIHJldHVybiB0aGlzLmlzU2hvcnRjdXRQcmVzc2VkKCdyZW1vdmVGcm9tU2VsZWN0aW9uJywgZXZlbnQpO1xuICB9XG5cbiAgZXh0ZW5kZWRTZWxlY3Rpb25TaG9ydGN1dChldmVudDogRXZlbnQpIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUb1NlbGVjdGlvbihldmVudCkgfHwgdGhpcy5yZW1vdmVGcm9tU2VsZWN0aW9uKGV2ZW50KTtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlU2hvcnRjdXRzRnJvbUNvbmZpZyhzaG9ydGN1dHM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0pIHtcbiAgICBjb25zdCBzaG9ydGN1dE1hcCA9IHt9O1xuXG4gICAgZm9yIChjb25zdCBba2V5LCBzaG9ydGN1dHNGb3JDb21tYW5kXSBvZiBPYmplY3QuZW50cmllcyhzaG9ydGN1dHMpKSB7XG4gICAgICBpZiAoIXRoaXMuaXNTdXBwb3J0ZWRTaG9ydGN1dChrZXkpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmdldEVycm9yTWVzc2FnZShgU2hvcnRjdXQgJHtrZXl9IG5vdCBzdXBwb3J0ZWRgKSk7XG4gICAgICB9XG5cbiAgICAgIHNob3J0Y3V0c0ZvckNvbW1hbmRcbiAgICAgICAgLnJlcGxhY2UoLyAvZywgJycpXG4gICAgICAgIC5zcGxpdCgnLCcpXG4gICAgICAgIC5mb3JFYWNoKHNob3J0Y3V0ID0+IHtcbiAgICAgICAgICBpZiAoIXNob3J0Y3V0TWFwW2tleV0pIHtcbiAgICAgICAgICAgIHNob3J0Y3V0TWFwW2tleV0gPSBbXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBjb21ibyA9IHNob3J0Y3V0LnNwbGl0KCcrJyk7XG4gICAgICAgICAgY29uc3QgY2xlYW5Db21ib3MgPSB0aGlzLnN1YnN0aXR1dGVLZXkoc2hvcnRjdXQsIGNvbWJvLCBNRVRBX0tFWSk7XG5cbiAgICAgICAgICBjbGVhbkNvbWJvcy5mb3JFYWNoKGNsZWFuQ29tYm8gPT4ge1xuICAgICAgICAgICAgY29uc3QgdW5zdXBwb3J0ZWRLZXkgPSB0aGlzLmlzU3VwcG9ydGVkQ29tYm8oY2xlYW5Db21ibyk7XG5cbiAgICAgICAgICAgIGlmICh1bnN1cHBvcnRlZEtleSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5nZXRFcnJvck1lc3NhZ2UoYEtleSAnJHt1bnN1cHBvcnRlZEtleX0nIGluIHNob3J0Y3V0ICR7c2hvcnRjdXR9IG5vdCBzdXBwb3J0ZWRgKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNob3J0Y3V0TWFwW2tleV0ucHVzaChjbGVhbkNvbWJvLm1hcChjb21ib0tleSA9PiBgJHtjb21ib0tleX1LZXlgKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBzaG9ydGN1dE1hcDtcbiAgfVxuXG4gIHByaXZhdGUgc3Vic3RpdHV0ZUtleShzaG9ydGN1dDogc3RyaW5nLCBjb21ibzogQXJyYXk8c3RyaW5nPiwgc3Vic3RpdHV0ZUtleTogc3RyaW5nKSB7XG4gICAgY29uc3QgaGFzU3BlY2lhbEtleSA9IHNob3J0Y3V0LmluY2x1ZGVzKHN1YnN0aXR1dGVLZXkpO1xuICAgIGNvbnN0IHN1YnN0aXR1dGVkU2hvcnRjdXQgPSBbXTtcblxuICAgIGlmIChoYXNTcGVjaWFsS2V5KSB7XG4gICAgICBjb25zdCBjbGVhblNob3J0Y3V0ID0gY29tYm8uZmlsdGVyKGVsZW1lbnQgPT4gZWxlbWVudCAhPT0gTUVUQV9LRVkpO1xuXG4gICAgICBLRVlfQUxJQVNFUy5tZXRhLmZvckVhY2goYWxpYXMgPT4ge1xuICAgICAgICBzdWJzdGl0dXRlZFNob3J0Y3V0LnB1c2goWy4uLmNsZWFuU2hvcnRjdXQsIGFsaWFzXSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3Vic3RpdHV0ZWRTaG9ydGN1dC5wdXNoKGNvbWJvKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3Vic3RpdHV0ZWRTaG9ydGN1dDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RXJyb3JNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZykge1xuICAgIHJldHVybiBgJHtFUlJPUl9QUkVGSVh9ICR7bWVzc2FnZX1gO1xuICB9XG5cbiAgcHJpdmF0ZSBpc1Nob3J0Y3V0UHJlc3NlZChzaG9ydGN1dE5hbWU6IHN0cmluZywgZXZlbnQ6IEV2ZW50KSB7XG4gICAgY29uc3Qgc2hvcnRjdXRzID0gdGhpcy5fc2hvcnRjdXRzW3Nob3J0Y3V0TmFtZV07XG5cbiAgICByZXR1cm4gc2hvcnRjdXRzLnNvbWUoc2hvcnRjdXQgPT4ge1xuICAgICAgcmV0dXJuIHNob3J0Y3V0LmV2ZXJ5KGtleSA9PiBldmVudFtrZXldKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgaXNTdXBwb3J0ZWRDb21ibyhjb21ibzogQXJyYXk8c3RyaW5nPikge1xuICAgIGxldCB1bnN1cHBvcnRlZEtleSA9IG51bGw7XG5cbiAgICBjb21iby5mb3JFYWNoKGtleSA9PiB7XG4gICAgICBpZiAoIVNVUFBPUlRFRF9LRVlTW2tleV0pIHtcbiAgICAgICAgdW5zdXBwb3J0ZWRLZXkgPSBrZXk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiB1bnN1cHBvcnRlZEtleTtcbiAgfVxuXG4gIHByaXZhdGUgaXNTdXBwb3J0ZWRTaG9ydGN1dChzaG9ydGN1dDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIFNVUFBPUlRFRF9TSE9SVENVVFNbc2hvcnRjdXRdO1xuICB9XG59XG4iLCJpbXBvcnQgeyBPYnNlcnZhYmxlLCBwaXBlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBmaWx0ZXIsIG1hcCwgd2l0aExhdGVzdEZyb20sIGRpc3RpbmN0VW50aWxDaGFuZ2VkIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgTW91c2VQb3NpdGlvbiwgU2VsZWN0Qm94LCBTZWxlY3RCb3hJbnB1dCwgU2VsZWN0Q29udGFpbmVySG9zdCB9IGZyb20gJy4vbW9kZWxzJztcbmltcG9ydCB7IGdldFJlbGF0aXZlTW91c2VQb3NpdGlvbiwgaGFzTWluaW11bVNpemUgfSBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVNlbGVjdEJveCA9IChjb250YWluZXI6IFNlbGVjdENvbnRhaW5lckhvc3QpID0+IChcbiAgc291cmNlOiBPYnNlcnZhYmxlPFNlbGVjdEJveElucHV0PlxuKTogT2JzZXJ2YWJsZTxTZWxlY3RCb3g8bnVtYmVyPj4gPT5cbiAgc291cmNlLnBpcGUoXG4gICAgbWFwKChbZXZlbnQsIG9wYWNpdHksIHsgeCwgeSB9XSkgPT4ge1xuICAgICAgLy8gVHlwZSBhbm5vdGF0aW9uIGlzIHJlcXVpcmVkIGhlcmUsIGJlY2F1c2UgYGdldFJlbGF0aXZlTW91c2VQb3NpdGlvbmAgcmV0dXJucyBhIGBNb3VzZVBvc2l0aW9uYCxcbiAgICAgIC8vIHRoZSBUUyBjb21waWxlciBjYW5ub3QgZmlndXJlIG91dCB0aGUgc2hhcGUgb2YgdGhpcyB0eXBlLlxuICAgICAgY29uc3QgbW91c2VQb3NpdGlvbjogTW91c2VQb3NpdGlvbiA9IGdldFJlbGF0aXZlTW91c2VQb3NpdGlvbihldmVudCwgY29udGFpbmVyKTtcblxuICAgICAgY29uc3Qgd2lkdGggPSBvcGFjaXR5ID4gMCA/IG1vdXNlUG9zaXRpb24ueCAtIHggOiAwO1xuICAgICAgY29uc3QgaGVpZ2h0ID0gb3BhY2l0eSA+IDAgPyBtb3VzZVBvc2l0aW9uLnkgLSB5IDogMDtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdG9wOiBoZWlnaHQgPCAwID8gbW91c2VQb3NpdGlvbi55IDogeSxcbiAgICAgICAgbGVmdDogd2lkdGggPCAwID8gbW91c2VQb3NpdGlvbi54IDogeCxcbiAgICAgICAgd2lkdGg6IE1hdGguYWJzKHdpZHRoKSxcbiAgICAgICAgaGVpZ2h0OiBNYXRoLmFicyhoZWlnaHQpLFxuICAgICAgICBvcGFjaXR5XG4gICAgICB9O1xuICAgIH0pXG4gICk7XG5cbmV4cG9ydCBjb25zdCB3aGVuU2VsZWN0Qm94VmlzaWJsZSA9IChzZWxlY3RCb3gkOiBPYnNlcnZhYmxlPFNlbGVjdEJveDxudW1iZXI+PikgPT4gKHNvdXJjZTogT2JzZXJ2YWJsZTxFdmVudD4pID0+XG4gIHNvdXJjZS5waXBlKFxuICAgIHdpdGhMYXRlc3RGcm9tKHNlbGVjdEJveCQpLFxuICAgIGZpbHRlcigoWywgc2VsZWN0Qm94XSkgPT4gaGFzTWluaW11bVNpemUoc2VsZWN0Qm94LCAwLCAwKSksXG4gICAgbWFwKChbZXZlbnQsIF9dKSA9PiBldmVudClcbiAgKTtcblxuZXhwb3J0IGNvbnN0IGRpc3RpbmN0S2V5RXZlbnRzID0gKCkgPT4gKHNvdXJjZTogT2JzZXJ2YWJsZTxLZXlib2FyZEV2ZW50PikgPT5cbiAgc291cmNlLnBpcGUoXG4gICAgZGlzdGluY3RVbnRpbENoYW5nZWQoKHByZXYsIGN1cnIpID0+IHtcbiAgICAgIHJldHVybiBwcmV2LmtleUNvZGUgPT09IGN1cnIua2V5Q29kZTtcbiAgICB9KVxuICApO1xuIiwiaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgU2VsZWN0SXRlbURpcmVjdGl2ZSB9IGZyb20gJy4vc2VsZWN0LWl0ZW0uZGlyZWN0aXZlJztcblxuZXhwb3J0IHR5cGUgUHJlZGljYXRlRm48VD4gPSAoaXRlbTogVCkgPT4gYm9vbGVhbjtcblxuZXhwb3J0IGVudW0gVXBkYXRlQWN0aW9ucyB7XG4gIEFkZCxcbiAgUmVtb3ZlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXBkYXRlQWN0aW9uIHtcbiAgdHlwZTogVXBkYXRlQWN0aW9ucztcbiAgaXRlbTogU2VsZWN0SXRlbURpcmVjdGl2ZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPYnNlcnZhYmxlUHJveHk8VD4ge1xuICBwcm94eSQ6IE9ic2VydmFibGU8YW55PjtcbiAgcHJveHk6IFQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VsZWN0Q29udGFpbmVySG9zdCBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgYm91bmRpbmdDbGllbnRSZWN0OiBCb3VuZGluZ0JveDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTaG9ydGN1dHMge1xuICBkaXNhYmxlU2VsZWN0aW9uOiBzdHJpbmc7XG4gIHRvZ2dsZVNpbmdsZUl0ZW06IHN0cmluZztcbiAgYWRkVG9TZWxlY3Rpb246IHN0cmluZztcbiAgcmVtb3ZlRnJvbVNlbGVjdGlvbjogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERyYWdUb1NlbGVjdENvbmZpZyB7XG4gIHNlbGVjdGVkQ2xhc3M6IHN0cmluZztcbiAgc2hvcnRjdXRzOiBQYXJ0aWFsPFNob3J0Y3V0cz47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW91c2VQb3NpdGlvbiB7XG4gIHg6IG51bWJlcjtcbiAgeTogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJvdW5kaW5nQm94IHtcbiAgdG9wOiBudW1iZXI7XG4gIGxlZnQ6IG51bWJlcjtcbiAgd2lkdGg6IG51bWJlcjtcbiAgaGVpZ2h0OiBudW1iZXI7XG59XG5cbmV4cG9ydCB0eXBlIFNlbGVjdEJveElucHV0ID0gW01vdXNlRXZlbnQsIG51bWJlciwgTW91c2VQb3NpdGlvbl07XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VsZWN0Qm94PFQ+IHtcbiAgdG9wOiBUO1xuICBsZWZ0OiBUO1xuICB3aWR0aDogVDtcbiAgaGVpZ2h0OiBUO1xuICBvcGFjaXR5OiBudW1iZXI7XG59XG5cbmV4cG9ydCBlbnVtIEFjdGlvbiB7XG4gIEFkZCxcbiAgRGVsZXRlLFxuICBOb25lXG59XG4iLCJpbXBvcnQge1xuICBDb21wb25lbnQsXG4gIEVsZW1lbnRSZWYsXG4gIE91dHB1dCxcbiAgRXZlbnRFbWl0dGVyLFxuICBJbnB1dCxcbiAgT25EZXN0cm95LFxuICBSZW5kZXJlcjIsXG4gIFZpZXdDaGlsZCxcbiAgTmdab25lLFxuICBDb250ZW50Q2hpbGRyZW4sXG4gIFF1ZXJ5TGlzdCxcbiAgSG9zdEJpbmRpbmcsXG4gIEFmdGVyVmlld0luaXQsXG4gIFBMQVRGT1JNX0lELFxuICBJbmplY3Rcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IGlzUGxhdGZvcm1Ccm93c2VyIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcblxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCwgY29tYmluZUxhdGVzdCwgbWVyZ2UsIGZyb20sIGZyb21FdmVudCwgQmVoYXZpb3JTdWJqZWN0LCBhc3luY1NjaGVkdWxlciB9IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQge1xuICBzd2l0Y2hNYXAsXG4gIHRha2VVbnRpbCxcbiAgbWFwLFxuICB0YXAsXG4gIGZpbHRlcixcbiAgYXVkaXRUaW1lLFxuICBtYXBUbyxcbiAgc2hhcmUsXG4gIHdpdGhMYXRlc3RGcm9tLFxuICBkaXN0aW5jdFVudGlsQ2hhbmdlZCxcbiAgb2JzZXJ2ZU9uLFxuICBzdGFydFdpdGgsXG4gIGNvbmNhdE1hcFRvLFxuICBmaXJzdFxufSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmltcG9ydCB7IFNlbGVjdEl0ZW1EaXJlY3RpdmUgfSBmcm9tICcuL3NlbGVjdC1pdGVtLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBTaG9ydGN1dFNlcnZpY2UgfSBmcm9tICcuL3Nob3J0Y3V0LnNlcnZpY2UnO1xuXG5pbXBvcnQgeyBjcmVhdGVTZWxlY3RCb3gsIHdoZW5TZWxlY3RCb3hWaXNpYmxlLCBkaXN0aW5jdEtleUV2ZW50cyB9IGZyb20gJy4vb3BlcmF0b3JzJztcblxuaW1wb3J0IHtcbiAgQWN0aW9uLFxuICBTZWxlY3RCb3gsXG4gIE1vdXNlUG9zaXRpb24sXG4gIFNlbGVjdENvbnRhaW5lckhvc3QsXG4gIFVwZGF0ZUFjdGlvbixcbiAgVXBkYXRlQWN0aW9ucyxcbiAgUHJlZGljYXRlRm5cbn0gZnJvbSAnLi9tb2RlbHMnO1xuXG5pbXBvcnQgeyBBVURJVF9USU1FLCBOT19TRUxFQ1RfQ0xBU1MgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5cbmltcG9ydCB7XG4gIGluQm91bmRpbmdCb3gsXG4gIGN1cnNvcldpdGhpbkVsZW1lbnQsXG4gIGNsZWFyU2VsZWN0aW9uLFxuICBib3hJbnRlcnNlY3RzLFxuICBjYWxjdWxhdGVCb3VuZGluZ0NsaWVudFJlY3QsXG4gIGdldFJlbGF0aXZlTW91c2VQb3NpdGlvbixcbiAgZ2V0TW91c2VQb3NpdGlvbixcbiAgaGFzTWluaW11bVNpemVcbn0gZnJvbSAnLi91dGlscyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2R0cy1zZWxlY3QtY29udGFpbmVyJyxcbiAgZXhwb3J0QXM6ICdkdHMtc2VsZWN0LWNvbnRhaW5lcicsXG4gIGhvc3Q6IHtcbiAgICBjbGFzczogJ2R0cy1zZWxlY3QtY29udGFpbmVyJ1xuICB9LFxuICB0ZW1wbGF0ZTogYFxuICAgIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cbiAgICA8ZGl2XG4gICAgICBjbGFzcz1cImR0cy1zZWxlY3QtYm94XCJcbiAgICAgICNzZWxlY3RCb3hcbiAgICAgIFtuZ0NsYXNzXT1cInNlbGVjdEJveENsYXNzZXMkIHwgYXN5bmNcIlxuICAgICAgW25nU3R5bGVdPVwic2VsZWN0Qm94U3R5bGVzJCB8IGFzeW5jXCJcbiAgICA+PC9kaXY+XG4gIGAsXG4gIHN0eWxlVXJsczogWycuL3NlbGVjdC1jb250YWluZXIuY29tcG9uZW50LnNjc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBTZWxlY3RDb250YWluZXJDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kge1xuICBob3N0OiBTZWxlY3RDb250YWluZXJIb3N0O1xuICBzZWxlY3RCb3hTdHlsZXMkOiBPYnNlcnZhYmxlPFNlbGVjdEJveDxzdHJpbmc+PjtcbiAgc2VsZWN0Qm94Q2xhc3NlcyQ6IE9ic2VydmFibGU8eyBba2V5OiBzdHJpbmddOiBib29sZWFuIH0+O1xuXG4gIEBWaWV3Q2hpbGQoJ3NlbGVjdEJveCcpXG4gIHByaXZhdGUgJHNlbGVjdEJveDogRWxlbWVudFJlZjtcblxuICBAQ29udGVudENoaWxkcmVuKFNlbGVjdEl0ZW1EaXJlY3RpdmUsIHsgZGVzY2VuZGFudHM6IHRydWUgfSlcbiAgcHJpdmF0ZSAkc2VsZWN0YWJsZUl0ZW1zOiBRdWVyeUxpc3Q8U2VsZWN0SXRlbURpcmVjdGl2ZT47XG5cbiAgQElucHV0KClcbiAgc2VsZWN0ZWRJdGVtczogYW55O1xuXG4gIEBJbnB1dCgpXG4gIHNlbGVjdE9uRHJhZyA9IHRydWU7XG5cbiAgQElucHV0KClcbiAgZGlzYWJsZWQgPSBmYWxzZTtcblxuICBASW5wdXQoKVxuICBkaXNhYmxlRHJhZyA9IGZhbHNlO1xuXG4gIEBJbnB1dCgpXG4gIHNlbGVjdE1vZGUgPSBmYWxzZTtcblxuICBASW5wdXQoKVxuICBzZWxlY3RXaXRoU2hvcnRjdXQgPSBmYWxzZTtcblxuICBASW5wdXQoKVxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmR0cy1jdXN0b20nKVxuICBjdXN0b20gPSBmYWxzZTtcblxuICBAT3V0cHV0KClcbiAgc2VsZWN0ZWRJdGVtc0NoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIEBPdXRwdXQoKVxuICBzZWxlY3QgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICBAT3V0cHV0KClcbiAgaXRlbVNlbGVjdGVkID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgQE91dHB1dCgpXG4gIGl0ZW1EZXNlbGVjdGVkID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgQE91dHB1dCgpXG4gIHNlbGVjdGlvblN0YXJ0ZWQgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG5cbiAgQE91dHB1dCgpXG4gIHNlbGVjdGlvbkVuZGVkID0gbmV3IEV2ZW50RW1pdHRlcjxBcnJheTxhbnk+PigpO1xuXG4gIHByaXZhdGUgX3RtcEl0ZW1zID0gbmV3IE1hcDxTZWxlY3RJdGVtRGlyZWN0aXZlLCBBY3Rpb24+KCk7XG5cbiAgcHJpdmF0ZSBfc2VsZWN0ZWRJdGVtcyQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PEFycmF5PGFueT4+KFtdKTtcbiAgcHJpdmF0ZSB1cGRhdGVJdGVtcyQgPSBuZXcgU3ViamVjdDxVcGRhdGVBY3Rpb24+KCk7XG4gIHByaXZhdGUgZGVzdHJveSQgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIEBJbmplY3QoUExBVEZPUk1fSUQpIHByaXZhdGUgcGxhdGZvcm1JZCxcbiAgICBwcml2YXRlIHNob3J0Y3V0czogU2hvcnRjdXRTZXJ2aWNlLFxuICAgIHByaXZhdGUgaG9zdEVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsXG4gICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLFxuICAgIHByaXZhdGUgbmdab25lOiBOZ1pvbmVcbiAgKSB7fVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xuICAgICAgdGhpcy5ob3N0ID0gdGhpcy5ob3N0RWxlbWVudFJlZi5uYXRpdmVFbGVtZW50O1xuXG4gICAgICB0aGlzLl9pbml0U2VsZWN0ZWRJdGVtc0NoYW5nZSgpO1xuXG4gICAgICB0aGlzLl9jYWxjdWxhdGVCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIHRoaXMuX29ic2VydmVCb3VuZGluZ1JlY3RDaGFuZ2VzKCk7XG4gICAgICB0aGlzLl9vYnNlcnZlU2VsZWN0YWJsZUl0ZW1zKCk7XG5cbiAgICAgIC8vIGRpc3RpbmN0S2V5RXZlbnRzIGlzIHVzZWQgdG8gcHJldmVudCBtdWx0aXBsZSBrZXkgZXZlbnRzIHRvIGJlIGZpcmVkIHJlcGVhdGVkbHlcbiAgICAgIC8vIG9uIFdpbmRvd3Mgd2hlbiBhIGtleSBpcyBiZWluZyBwcmVzc2VkXG5cbiAgICAgIGNvbnN0IGtleWRvd24kID0gZnJvbUV2ZW50PEtleWJvYXJkRXZlbnQ+KHdpbmRvdywgJ2tleWRvd24nKS5waXBlKFxuICAgICAgICBkaXN0aW5jdEtleUV2ZW50cygpLFxuICAgICAgICBzaGFyZSgpXG4gICAgICApO1xuXG4gICAgICBjb25zdCBrZXl1cCQgPSBmcm9tRXZlbnQ8S2V5Ym9hcmRFdmVudD4od2luZG93LCAna2V5dXAnKS5waXBlKFxuICAgICAgICBkaXN0aW5jdEtleUV2ZW50cygpLFxuICAgICAgICBzaGFyZSgpXG4gICAgICApO1xuXG4gICAgICBjb25zdCBtb3VzZXVwJCA9IGZyb21FdmVudDxNb3VzZUV2ZW50Pih3aW5kb3csICdtb3VzZXVwJykucGlwZShcbiAgICAgICAgZmlsdGVyKCgpID0+ICF0aGlzLmRpc2FibGVkKSxcbiAgICAgICAgdGFwKCgpID0+IHRoaXMuX29uTW91c2VVcCgpKSxcbiAgICAgICAgc2hhcmUoKVxuICAgICAgKTtcblxuICAgICAgY29uc3QgbW91c2Vtb3ZlJCA9IGZyb21FdmVudDxNb3VzZUV2ZW50Pih3aW5kb3csICdtb3VzZW1vdmUnKS5waXBlKFxuICAgICAgICBmaWx0ZXIoKCkgPT4gIXRoaXMuZGlzYWJsZWQpLFxuICAgICAgICBzaGFyZSgpXG4gICAgICApO1xuXG4gICAgICBjb25zdCBtb3VzZWRvd24kID0gZnJvbUV2ZW50PE1vdXNlRXZlbnQ+KHRoaXMuaG9zdCwgJ21vdXNlZG93bicpLnBpcGUoXG4gICAgICAgIGZpbHRlcihldmVudCA9PiBldmVudC5idXR0b24gPT09IDApLCAvLyBvbmx5IGVtaXQgbGVmdCBtb3VzZVxuICAgICAgICBmaWx0ZXIoKCkgPT4gIXRoaXMuZGlzYWJsZWQpLFxuICAgICAgICB0YXAoZXZlbnQgPT4gdGhpcy5fb25Nb3VzZURvd24oZXZlbnQpKSxcbiAgICAgICAgc2hhcmUoKVxuICAgICAgKTtcblxuICAgICAgY29uc3QgZHJhZ2dpbmckID0gbW91c2Vkb3duJC5waXBlKFxuICAgICAgICBmaWx0ZXIoZXZlbnQgPT4gIXRoaXMuc2hvcnRjdXRzLmRpc2FibGVTZWxlY3Rpb24oZXZlbnQpKSxcbiAgICAgICAgZmlsdGVyKCgpID0+ICF0aGlzLnNlbGVjdE1vZGUpLFxuICAgICAgICBmaWx0ZXIoKCkgPT4gIXRoaXMuZGlzYWJsZURyYWcpLFxuICAgICAgICBzd2l0Y2hNYXAoKCkgPT4gbW91c2Vtb3ZlJC5waXBlKHRha2VVbnRpbChtb3VzZXVwJCkpKSxcbiAgICAgICAgc2hhcmUoKVxuICAgICAgKTtcblxuICAgICAgY29uc3QgY3VycmVudE1vdXNlUG9zaXRpb24kOiBPYnNlcnZhYmxlPE1vdXNlUG9zaXRpb24+ID0gbW91c2Vkb3duJC5waXBlKFxuICAgICAgICBtYXAoKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiBnZXRSZWxhdGl2ZU1vdXNlUG9zaXRpb24oZXZlbnQsIHRoaXMuaG9zdCkpXG4gICAgICApO1xuXG4gICAgICBjb25zdCBzaG93JCA9IGRyYWdnaW5nJC5waXBlKG1hcFRvKDEpKTtcbiAgICAgIGNvbnN0IGhpZGUkID0gbW91c2V1cCQucGlwZShtYXBUbygwKSk7XG4gICAgICBjb25zdCBvcGFjaXR5JCA9IG1lcmdlKHNob3ckLCBoaWRlJCkucGlwZShkaXN0aW5jdFVudGlsQ2hhbmdlZCgpKTtcblxuICAgICAgY29uc3Qgc2VsZWN0Qm94JCA9IGNvbWJpbmVMYXRlc3QoZHJhZ2dpbmckLCBvcGFjaXR5JCwgY3VycmVudE1vdXNlUG9zaXRpb24kKS5waXBlKFxuICAgICAgICBjcmVhdGVTZWxlY3RCb3godGhpcy5ob3N0KSxcbiAgICAgICAgc2hhcmUoKVxuICAgICAgKTtcblxuICAgICAgdGhpcy5zZWxlY3RCb3hDbGFzc2VzJCA9IG1lcmdlKGRyYWdnaW5nJCwgbW91c2V1cCQsIGtleWRvd24kLCBrZXl1cCQpLnBpcGUoXG4gICAgICAgIGF1ZGl0VGltZShBVURJVF9USU1FKSxcbiAgICAgICAgd2l0aExhdGVzdEZyb20oc2VsZWN0Qm94JCksXG4gICAgICAgIG1hcCgoW2V2ZW50LCBzZWxlY3RCb3hdKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICdkdHMtYWRkaW5nJzogaGFzTWluaW11bVNpemUoc2VsZWN0Qm94LCAwLCAwKSAmJiAhdGhpcy5zaG9ydGN1dHMucmVtb3ZlRnJvbVNlbGVjdGlvbihldmVudCksXG4gICAgICAgICAgICAnZHRzLXJlbW92aW5nJzogdGhpcy5zaG9ydGN1dHMucmVtb3ZlRnJvbVNlbGVjdGlvbihldmVudClcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgICAgZGlzdGluY3RVbnRpbENoYW5nZWQoKGEsIGIpID0+IEpTT04uc3RyaW5naWZ5KGEpID09PSBKU09OLnN0cmluZ2lmeShiKSlcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHNlbGVjdE9uTW91c2VVcCQgPSBkcmFnZ2luZyQucGlwZShcbiAgICAgICAgZmlsdGVyKCgpID0+ICF0aGlzLnNlbGVjdE9uRHJhZyksXG4gICAgICAgIGZpbHRlcigoKSA9PiAhdGhpcy5zZWxlY3RNb2RlKSxcbiAgICAgICAgZmlsdGVyKGV2ZW50ID0+IHRoaXMuX2N1cnNvcldpdGhpbkhvc3QoZXZlbnQpKSxcbiAgICAgICAgc3dpdGNoTWFwKF8gPT4gbW91c2V1cCQucGlwZShmaXJzdCgpKSksXG4gICAgICAgIGZpbHRlcihcbiAgICAgICAgICBldmVudCA9PlxuICAgICAgICAgICAgKCF0aGlzLnNob3J0Y3V0cy5kaXNhYmxlU2VsZWN0aW9uKGV2ZW50KSAmJiAhdGhpcy5zaG9ydGN1dHMudG9nZ2xlU2luZ2xlSXRlbShldmVudCkpIHx8XG4gICAgICAgICAgICB0aGlzLnNob3J0Y3V0cy5yZW1vdmVGcm9tU2VsZWN0aW9uKGV2ZW50KVxuICAgICAgICApXG4gICAgICApO1xuXG4gICAgICBjb25zdCBzZWxlY3RPbkRyYWckID0gc2VsZWN0Qm94JC5waXBlKFxuICAgICAgICBhdWRpdFRpbWUoQVVESVRfVElNRSksXG4gICAgICAgIHdpdGhMYXRlc3RGcm9tKG1vdXNlbW92ZSQsIChzZWxlY3RCb3gsIGV2ZW50OiBNb3VzZUV2ZW50KSA9PiAoe1xuICAgICAgICAgIHNlbGVjdEJveCxcbiAgICAgICAgICBldmVudFxuICAgICAgICB9KSksXG4gICAgICAgIGZpbHRlcigoKSA9PiB0aGlzLnNlbGVjdE9uRHJhZyksXG4gICAgICAgIGZpbHRlcigoeyBzZWxlY3RCb3ggfSkgPT4gaGFzTWluaW11bVNpemUoc2VsZWN0Qm94KSksXG4gICAgICAgIG1hcCgoeyBldmVudCB9KSA9PiBldmVudClcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHNlbGVjdE9uS2V5Ym9hcmRFdmVudCQgPSBtZXJnZShrZXlkb3duJCwga2V5dXAkKS5waXBlKFxuICAgICAgICBhdWRpdFRpbWUoQVVESVRfVElNRSksXG4gICAgICAgIHdoZW5TZWxlY3RCb3hWaXNpYmxlKHNlbGVjdEJveCQpLFxuICAgICAgICB0YXAoZXZlbnQgPT4ge1xuICAgICAgICAgIGlmICh0aGlzLl9pc0V4dGVuZGVkU2VsZWN0aW9uKGV2ZW50KSkge1xuICAgICAgICAgICAgdGhpcy5fdG1wSXRlbXMuY2xlYXIoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZmx1c2hJdGVtcygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICk7XG5cbiAgICAgIG1lcmdlKHNlbGVjdE9uTW91c2VVcCQsIHNlbGVjdE9uRHJhZyQsIHNlbGVjdE9uS2V5Ym9hcmRFdmVudCQpXG4gICAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSlcbiAgICAgICAgLnN1YnNjcmliZShldmVudCA9PiB0aGlzLl9zZWxlY3RJdGVtcyhldmVudCkpO1xuXG4gICAgICB0aGlzLnNlbGVjdEJveFN0eWxlcyQgPSBzZWxlY3RCb3gkLnBpcGUoXG4gICAgICAgIG1hcChzZWxlY3RCb3ggPT4gKHtcbiAgICAgICAgICB0b3A6IGAke3NlbGVjdEJveC50b3B9cHhgLFxuICAgICAgICAgIGxlZnQ6IGAke3NlbGVjdEJveC5sZWZ0fXB4YCxcbiAgICAgICAgICB3aWR0aDogYCR7c2VsZWN0Qm94LndpZHRofXB4YCxcbiAgICAgICAgICBoZWlnaHQ6IGAke3NlbGVjdEJveC5oZWlnaHR9cHhgLFxuICAgICAgICAgIG9wYWNpdHk6IHNlbGVjdEJveC5vcGFjaXR5XG4gICAgICAgIH0pKVxuICAgICAgKTtcblxuICAgICAgdGhpcy5faW5pdFNlbGVjdGlvbk91dHB1dHMobW91c2Vkb3duJCwgbW91c2V1cCQpO1xuICAgIH1cbiAgfVxuXG4gIHNlbGVjdEFsbCgpIHtcbiAgICB0aGlzLiRzZWxlY3RhYmxlSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgIHRoaXMuX3NlbGVjdEl0ZW0oaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICB0b2dnbGVJdGVtczxUPihwcmVkaWNhdGU6IFByZWRpY2F0ZUZuPFQ+KSB7XG4gICAgdGhpcy5fZmlsdGVyU2VsZWN0YWJsZUl0ZW1zKHByZWRpY2F0ZSkuc3Vic2NyaWJlKChpdGVtOiBTZWxlY3RJdGVtRGlyZWN0aXZlKSA9PiB0aGlzLl90b2dnbGVJdGVtKGl0ZW0pKTtcbiAgfVxuXG4gIHNlbGVjdEl0ZW1zPFQ+KHByZWRpY2F0ZTogUHJlZGljYXRlRm48VD4pIHtcbiAgICB0aGlzLl9maWx0ZXJTZWxlY3RhYmxlSXRlbXMocHJlZGljYXRlKS5zdWJzY3JpYmUoKGl0ZW06IFNlbGVjdEl0ZW1EaXJlY3RpdmUpID0+IHRoaXMuX3NlbGVjdEl0ZW0oaXRlbSkpO1xuICB9XG5cbiAgZGVzZWxlY3RJdGVtczxUPihwcmVkaWNhdGU6IFByZWRpY2F0ZUZuPFQ+KSB7XG4gICAgdGhpcy5fZmlsdGVyU2VsZWN0YWJsZUl0ZW1zKHByZWRpY2F0ZSkuc3Vic2NyaWJlKChpdGVtOiBTZWxlY3RJdGVtRGlyZWN0aXZlKSA9PiB0aGlzLl9kZXNlbGVjdEl0ZW0oaXRlbSkpO1xuICB9XG5cbiAgY2xlYXJTZWxlY3Rpb24oKSB7XG4gICAgdGhpcy4kc2VsZWN0YWJsZUl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICB0aGlzLl9kZXNlbGVjdEl0ZW0oaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGUoKSB7XG4gICAgdGhpcy5fY2FsY3VsYXRlQm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgdGhpcy4kc2VsZWN0YWJsZUl0ZW1zLmZvckVhY2goaXRlbSA9PiBpdGVtLmNhbGN1bGF0ZUJvdW5kaW5nQ2xpZW50UmVjdCgpKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMuZGVzdHJveSQubmV4dCgpO1xuICAgIHRoaXMuZGVzdHJveSQuY29tcGxldGUoKTtcbiAgfVxuXG4gIHByaXZhdGUgX2ZpbHRlclNlbGVjdGFibGVJdGVtczxUPihwcmVkaWNhdGU6IFByZWRpY2F0ZUZuPFQ+KSB7XG4gICAgLy8gV3JhcCBzZWxlY3QgaXRlbXMgaW4gYW4gb2JzZXJ2YWJsZSBmb3IgYmV0dGVyIGVmZmljaWVuY3kgYXNcbiAgICAvLyBubyBpbnRlcm1lZGlhdGUgYXJyYXlzIGFyZSBjcmVhdGVkIGFuZCB3ZSBvbmx5IG5lZWQgdG8gcHJvY2Vzc1xuICAgIC8vIGV2ZXJ5IGl0ZW0gb25jZS5cbiAgICByZXR1cm4gZnJvbSh0aGlzLiRzZWxlY3RhYmxlSXRlbXMudG9BcnJheSgpKS5waXBlKGZpbHRlcihpdGVtID0+IHByZWRpY2F0ZShpdGVtLnZhbHVlKSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBfaW5pdFNlbGVjdGVkSXRlbXNDaGFuZ2UoKSB7XG4gICAgdGhpcy5fc2VsZWN0ZWRJdGVtcyRcbiAgICAgIC5waXBlKFxuICAgICAgICBhdWRpdFRpbWUoQVVESVRfVElNRSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSh7XG4gICAgICAgIG5leHQ6IHNlbGVjdGVkSXRlbXMgPT4ge1xuICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtc0NoYW5nZS5lbWl0KHNlbGVjdGVkSXRlbXMpO1xuICAgICAgICAgIHRoaXMuc2VsZWN0LmVtaXQoc2VsZWN0ZWRJdGVtcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBsZXRlOiAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5zZWxlY3RlZEl0ZW1zQ2hhbmdlLmVtaXQoW10pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX29ic2VydmVTZWxlY3RhYmxlSXRlbXMoKSB7XG4gICAgLy8gTGlzdGVuIGZvciB1cGRhdGVzIGFuZCBlaXRoZXIgc2VsZWN0IG9yIGRlc2VsZWN0IGFuIGl0ZW1cbiAgICB0aGlzLnVwZGF0ZUl0ZW1zJFxuICAgICAgLnBpcGUoXG4gICAgICAgIHdpdGhMYXRlc3RGcm9tKHRoaXMuX3NlbGVjdGVkSXRlbXMkKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKChbdXBkYXRlLCBzZWxlY3RlZEl0ZW1zXTogW1VwZGF0ZUFjdGlvbiwgYW55W11dKSA9PiB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSB1cGRhdGUuaXRlbTtcblxuICAgICAgICBzd2l0Y2ggKHVwZGF0ZS50eXBlKSB7XG4gICAgICAgICAgY2FzZSBVcGRhdGVBY3Rpb25zLkFkZDpcbiAgICAgICAgICAgIGlmICh0aGlzLl9hZGRJdGVtKGl0ZW0sIHNlbGVjdGVkSXRlbXMpKSB7XG4gICAgICAgICAgICAgIGl0ZW0uX3NlbGVjdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBVcGRhdGVBY3Rpb25zLlJlbW92ZTpcbiAgICAgICAgICAgIGlmICh0aGlzLl9yZW1vdmVJdGVtKGl0ZW0sIHNlbGVjdGVkSXRlbXMpKSB7XG4gICAgICAgICAgICAgIGl0ZW0uX2Rlc2VsZWN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAvLyBVcGRhdGUgdGhlIGNvbnRhaW5lciBhcyB3ZWxsIGFzIGFsbCBzZWxlY3RhYmxlIGl0ZW1zIGlmIHRoZSBsaXN0IGhhcyBjaGFuZ2VkXG4gICAgdGhpcy4kc2VsZWN0YWJsZUl0ZW1zLmNoYW5nZXNcbiAgICAgIC5waXBlKFxuICAgICAgICB3aXRoTGF0ZXN0RnJvbSh0aGlzLl9zZWxlY3RlZEl0ZW1zJCksXG4gICAgICAgIG9ic2VydmVPbihhc3luY1NjaGVkdWxlciksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgoW2l0ZW1zLCBzZWxlY3RlZEl0ZW1zXTogW1F1ZXJ5TGlzdDxTZWxlY3RJdGVtRGlyZWN0aXZlPiwgYW55W11dKSA9PiB7XG4gICAgICAgIGNvbnN0IG5ld0xpc3QgPSBpdGVtcy50b0FycmF5KCk7XG4gICAgICAgIGNvbnN0IHJlbW92ZWRJdGVtcyA9IHNlbGVjdGVkSXRlbXMuZmlsdGVyKGl0ZW0gPT4gIW5ld0xpc3QuaW5jbHVkZXMoaXRlbS52YWx1ZSkpO1xuXG4gICAgICAgIGlmIChyZW1vdmVkSXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgcmVtb3ZlZEl0ZW1zLmZvckVhY2goaXRlbSA9PiB0aGlzLl9yZW1vdmVJdGVtKGl0ZW0sIHNlbGVjdGVkSXRlbXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX29ic2VydmVCb3VuZGluZ1JlY3RDaGFuZ2VzKCkge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIGNvbnN0IHJlc2l6ZSQgPSBmcm9tRXZlbnQod2luZG93LCAncmVzaXplJyk7XG4gICAgICBjb25zdCB3aW5kb3dTY3JvbGwkID0gZnJvbUV2ZW50KHdpbmRvdywgJ3Njcm9sbCcpO1xuICAgICAgY29uc3QgY29udGFpbmVyU2Nyb2xsJCA9IGZyb21FdmVudCh0aGlzLmhvc3QsICdzY3JvbGwnKTtcblxuICAgICAgbWVyZ2UocmVzaXplJCwgd2luZG93U2Nyb2xsJCwgY29udGFpbmVyU2Nyb2xsJClcbiAgICAgICAgLnBpcGUoXG4gICAgICAgICAgc3RhcnRXaXRoKCdJTklUSUFMX1VQREFURScpLFxuICAgICAgICAgIGF1ZGl0VGltZShBVURJVF9USU1FKSxcbiAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JClcbiAgICAgICAgKVxuICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX2luaXRTZWxlY3Rpb25PdXRwdXRzKG1vdXNlZG93biQ6IE9ic2VydmFibGU8TW91c2VFdmVudD4sIG1vdXNldXAkOiBPYnNlcnZhYmxlPE1vdXNlRXZlbnQ+KSB7XG4gICAgbW91c2Vkb3duJFxuICAgICAgLnBpcGUoXG4gICAgICAgIGZpbHRlcihldmVudCA9PiB0aGlzLl9jdXJzb3JXaXRoaW5Ib3N0KGV2ZW50KSksXG4gICAgICAgIHRhcCgoKSA9PiB0aGlzLnNlbGVjdGlvblN0YXJ0ZWQuZW1pdCgpKSxcbiAgICAgICAgY29uY2F0TWFwVG8obW91c2V1cCQucGlwZShmaXJzdCgpKSksXG4gICAgICAgIHdpdGhMYXRlc3RGcm9tKHRoaXMuX3NlbGVjdGVkSXRlbXMkKSxcbiAgICAgICAgbWFwKChbLCBpdGVtc10pID0+IGl0ZW1zKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKGl0ZW1zID0+IHtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25FbmRlZC5lbWl0KGl0ZW1zKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBfY2FsY3VsYXRlQm91bmRpbmdDbGllbnRSZWN0KCkge1xuICAgIHRoaXMuaG9zdC5ib3VuZGluZ0NsaWVudFJlY3QgPSBjYWxjdWxhdGVCb3VuZGluZ0NsaWVudFJlY3QodGhpcy5ob3N0KTtcbiAgfVxuXG4gIHByaXZhdGUgX2N1cnNvcldpdGhpbkhvc3QoZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICByZXR1cm4gY3Vyc29yV2l0aGluRWxlbWVudChldmVudCwgdGhpcy5ob3N0KTtcbiAgfVxuXG4gIHByaXZhdGUgX29uTW91c2VVcCgpIHtcbiAgICB0aGlzLl9mbHVzaEl0ZW1zKCk7XG4gICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyhkb2N1bWVudC5ib2R5LCBOT19TRUxFQ1RfQ0xBU1MpO1xuICB9XG5cbiAgcHJpdmF0ZSBfb25Nb3VzZURvd24oZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBpZiAodGhpcy5zaG9ydGN1dHMuZGlzYWJsZVNlbGVjdGlvbihldmVudCkgfHwgdGhpcy5kaXNhYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNsZWFyU2VsZWN0aW9uKHdpbmRvdyk7XG5cbiAgICBpZiAoIXRoaXMuZGlzYWJsZURyYWcpIHtcbiAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3MoZG9jdW1lbnQuYm9keSwgTk9fU0VMRUNUX0NMQVNTKTtcbiAgICB9XG5cbiAgICBjb25zdCBtb3VzZVBvaW50ID0gZ2V0TW91c2VQb3NpdGlvbihldmVudCk7XG5cbiAgICB0aGlzLiRzZWxlY3RhYmxlSXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IGl0ZW1SZWN0ID0gaXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIGNvbnN0IHdpdGhpbkJvdW5kaW5nQm94ID0gaW5Cb3VuZGluZ0JveChtb3VzZVBvaW50LCBpdGVtUmVjdCk7XG5cbiAgICAgIGlmICh0aGlzLnNob3J0Y3V0cy5leHRlbmRlZFNlbGVjdGlvblNob3J0Y3V0KGV2ZW50KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHNob3VsZEFkZCA9XG4gICAgICAgICh3aXRoaW5Cb3VuZGluZ0JveCAmJlxuICAgICAgICAgICF0aGlzLnNob3J0Y3V0cy50b2dnbGVTaW5nbGVJdGVtKGV2ZW50KSAmJlxuICAgICAgICAgICF0aGlzLnNlbGVjdE1vZGUgJiZcbiAgICAgICAgICAhdGhpcy5zZWxlY3RXaXRoU2hvcnRjdXQpIHx8XG4gICAgICAgICh3aXRoaW5Cb3VuZGluZ0JveCAmJiB0aGlzLnNob3J0Y3V0cy50b2dnbGVTaW5nbGVJdGVtKGV2ZW50KSAmJiAhaXRlbS5zZWxlY3RlZCkgfHxcbiAgICAgICAgKCF3aXRoaW5Cb3VuZGluZ0JveCAmJiB0aGlzLnNob3J0Y3V0cy50b2dnbGVTaW5nbGVJdGVtKGV2ZW50KSAmJiBpdGVtLnNlbGVjdGVkKSB8fFxuICAgICAgICAod2l0aGluQm91bmRpbmdCb3ggJiYgIWl0ZW0uc2VsZWN0ZWQgJiYgdGhpcy5zZWxlY3RNb2RlKSB8fFxuICAgICAgICAoIXdpdGhpbkJvdW5kaW5nQm94ICYmIGl0ZW0uc2VsZWN0ZWQgJiYgdGhpcy5zZWxlY3RNb2RlKTtcblxuICAgICAgY29uc3Qgc2hvdWxkUmVtb3ZlID1cbiAgICAgICAgKCF3aXRoaW5Cb3VuZGluZ0JveCAmJlxuICAgICAgICAgICF0aGlzLnNob3J0Y3V0cy50b2dnbGVTaW5nbGVJdGVtKGV2ZW50KSAmJlxuICAgICAgICAgICF0aGlzLnNlbGVjdE1vZGUgJiZcbiAgICAgICAgICAhdGhpcy5zZWxlY3RXaXRoU2hvcnRjdXQpIHx8XG4gICAgICAgICghd2l0aGluQm91bmRpbmdCb3ggJiYgdGhpcy5zaG9ydGN1dHMudG9nZ2xlU2luZ2xlSXRlbShldmVudCkgJiYgIWl0ZW0uc2VsZWN0ZWQpIHx8XG4gICAgICAgICh3aXRoaW5Cb3VuZGluZ0JveCAmJiB0aGlzLnNob3J0Y3V0cy50b2dnbGVTaW5nbGVJdGVtKGV2ZW50KSAmJiBpdGVtLnNlbGVjdGVkKSB8fFxuICAgICAgICAoIXdpdGhpbkJvdW5kaW5nQm94ICYmICFpdGVtLnNlbGVjdGVkICYmIHRoaXMuc2VsZWN0TW9kZSkgfHxcbiAgICAgICAgKHdpdGhpbkJvdW5kaW5nQm94ICYmIGl0ZW0uc2VsZWN0ZWQgJiYgdGhpcy5zZWxlY3RNb2RlKTtcblxuICAgICAgaWYgKHNob3VsZEFkZCkge1xuICAgICAgICB0aGlzLl9zZWxlY3RJdGVtKGl0ZW0pO1xuICAgICAgfSBlbHNlIGlmIChzaG91bGRSZW1vdmUpIHtcbiAgICAgICAgdGhpcy5fZGVzZWxlY3RJdGVtKGl0ZW0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBfc2VsZWN0SXRlbXMoZXZlbnQ6IEV2ZW50KSB7XG4gICAgY29uc3Qgc2VsZWN0aW9uQm94ID0gY2FsY3VsYXRlQm91bmRpbmdDbGllbnRSZWN0KHRoaXMuJHNlbGVjdEJveC5uYXRpdmVFbGVtZW50KTtcblxuICAgIHRoaXMuJHNlbGVjdGFibGVJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgaWYgKHRoaXMuX2lzRXh0ZW5kZWRTZWxlY3Rpb24oZXZlbnQpKSB7XG4gICAgICAgIHRoaXMuX2V4dGVuZGVkU2VsZWN0aW9uTW9kZShzZWxlY3Rpb25Cb3gsIGl0ZW0sIGV2ZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX25vcm1hbFNlbGVjdGlvbk1vZGUoc2VsZWN0aW9uQm94LCBpdGVtLCBldmVudCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIF9pc0V4dGVuZGVkU2VsZWN0aW9uKGV2ZW50OiBFdmVudCkge1xuICAgIHJldHVybiB0aGlzLnNob3J0Y3V0cy5leHRlbmRlZFNlbGVjdGlvblNob3J0Y3V0KGV2ZW50KSAmJiB0aGlzLnNlbGVjdE9uRHJhZztcbiAgfVxuXG4gIHByaXZhdGUgX25vcm1hbFNlbGVjdGlvbk1vZGUoc2VsZWN0Qm94LCBpdGVtOiBTZWxlY3RJdGVtRGlyZWN0aXZlLCBldmVudDogRXZlbnQpIHtcbiAgICBjb25zdCBpblNlbGVjdGlvbiA9IGJveEludGVyc2VjdHMoc2VsZWN0Qm94LCBpdGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKTtcblxuICAgIGNvbnN0IHNob3VsZEFkZCA9IGluU2VsZWN0aW9uICYmICFpdGVtLnNlbGVjdGVkICYmICF0aGlzLnNob3J0Y3V0cy5yZW1vdmVGcm9tU2VsZWN0aW9uKGV2ZW50KTtcblxuICAgIGNvbnN0IHNob3VsZFJlbW92ZSA9XG4gICAgICAoIWluU2VsZWN0aW9uICYmIGl0ZW0uc2VsZWN0ZWQgJiYgIXRoaXMuc2hvcnRjdXRzLmFkZFRvU2VsZWN0aW9uKGV2ZW50KSkgfHxcbiAgICAgIChpblNlbGVjdGlvbiAmJiBpdGVtLnNlbGVjdGVkICYmIHRoaXMuc2hvcnRjdXRzLnJlbW92ZUZyb21TZWxlY3Rpb24oZXZlbnQpKTtcblxuICAgIGlmIChzaG91bGRBZGQpIHtcbiAgICAgIHRoaXMuX3NlbGVjdEl0ZW0oaXRlbSk7XG4gICAgfSBlbHNlIGlmIChzaG91bGRSZW1vdmUpIHtcbiAgICAgIHRoaXMuX2Rlc2VsZWN0SXRlbShpdGVtKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9leHRlbmRlZFNlbGVjdGlvbk1vZGUoc2VsZWN0Qm94LCBpdGVtOiBTZWxlY3RJdGVtRGlyZWN0aXZlLCBldmVudDogRXZlbnQpIHtcbiAgICBjb25zdCBpblNlbGVjdGlvbiA9IGJveEludGVyc2VjdHMoc2VsZWN0Qm94LCBpdGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKTtcblxuICAgIGNvbnN0IHNob3VkbEFkZCA9XG4gICAgICAoaW5TZWxlY3Rpb24gJiYgIWl0ZW0uc2VsZWN0ZWQgJiYgIXRoaXMuc2hvcnRjdXRzLnJlbW92ZUZyb21TZWxlY3Rpb24oZXZlbnQpICYmICF0aGlzLl90bXBJdGVtcy5oYXMoaXRlbSkpIHx8XG4gICAgICAoaW5TZWxlY3Rpb24gJiYgaXRlbS5zZWxlY3RlZCAmJiB0aGlzLnNob3J0Y3V0cy5yZW1vdmVGcm9tU2VsZWN0aW9uKGV2ZW50KSAmJiAhdGhpcy5fdG1wSXRlbXMuaGFzKGl0ZW0pKTtcblxuICAgIGNvbnN0IHNob3VsZFJlbW92ZSA9XG4gICAgICAoIWluU2VsZWN0aW9uICYmIGl0ZW0uc2VsZWN0ZWQgJiYgdGhpcy5zaG9ydGN1dHMuYWRkVG9TZWxlY3Rpb24oZXZlbnQpICYmIHRoaXMuX3RtcEl0ZW1zLmhhcyhpdGVtKSkgfHxcbiAgICAgICghaW5TZWxlY3Rpb24gJiYgIWl0ZW0uc2VsZWN0ZWQgJiYgdGhpcy5zaG9ydGN1dHMucmVtb3ZlRnJvbVNlbGVjdGlvbihldmVudCkgJiYgdGhpcy5fdG1wSXRlbXMuaGFzKGl0ZW0pKTtcblxuICAgIGlmIChzaG91ZGxBZGQpIHtcbiAgICAgIGl0ZW0uc2VsZWN0ZWQgPyBpdGVtLl9kZXNlbGVjdCgpIDogaXRlbS5fc2VsZWN0KCk7XG5cbiAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMuc2hvcnRjdXRzLnJlbW92ZUZyb21TZWxlY3Rpb24oZXZlbnQpXG4gICAgICAgID8gQWN0aW9uLkRlbGV0ZVxuICAgICAgICA6IHRoaXMuc2hvcnRjdXRzLmFkZFRvU2VsZWN0aW9uKGV2ZW50KVxuICAgICAgICA/IEFjdGlvbi5BZGRcbiAgICAgICAgOiBBY3Rpb24uTm9uZTtcblxuICAgICAgdGhpcy5fdG1wSXRlbXMuc2V0KGl0ZW0sIGFjdGlvbik7XG4gICAgfSBlbHNlIGlmIChzaG91bGRSZW1vdmUpIHtcbiAgICAgIHRoaXMuc2hvcnRjdXRzLnJlbW92ZUZyb21TZWxlY3Rpb24oZXZlbnQpID8gaXRlbS5fc2VsZWN0KCkgOiBpdGVtLl9kZXNlbGVjdCgpO1xuICAgICAgdGhpcy5fdG1wSXRlbXMuZGVsZXRlKGl0ZW0pO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX2ZsdXNoSXRlbXMoKSB7XG4gICAgdGhpcy5fdG1wSXRlbXMuZm9yRWFjaCgoYWN0aW9uLCBpdGVtKSA9PiB7XG4gICAgICBpZiAoYWN0aW9uID09PSBBY3Rpb24uQWRkKSB7XG4gICAgICAgIHRoaXMuX3NlbGVjdEl0ZW0oaXRlbSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChhY3Rpb24gPT09IEFjdGlvbi5EZWxldGUpIHtcbiAgICAgICAgdGhpcy5fZGVzZWxlY3RJdGVtKGl0ZW0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5fdG1wSXRlbXMuY2xlYXIoKTtcbiAgfVxuXG4gIHByaXZhdGUgX2FkZEl0ZW0oaXRlbTogU2VsZWN0SXRlbURpcmVjdGl2ZSwgc2VsZWN0ZWRJdGVtczogQXJyYXk8YW55Pikge1xuICAgIGxldCBzdWNjZXNzID0gZmFsc2U7XG5cbiAgICBpZiAoIXRoaXMuX2hhc0l0ZW0oaXRlbSwgc2VsZWN0ZWRJdGVtcykpIHtcbiAgICAgIHN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgc2VsZWN0ZWRJdGVtcy5wdXNoKGl0ZW0udmFsdWUpO1xuICAgICAgdGhpcy5fc2VsZWN0ZWRJdGVtcyQubmV4dChzZWxlY3RlZEl0ZW1zKTtcbiAgICAgIHRoaXMuaXRlbVNlbGVjdGVkLmVtaXQoaXRlbS52YWx1ZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1Y2Nlc3M7XG4gIH1cblxuICBwcml2YXRlIF9yZW1vdmVJdGVtKGl0ZW06IFNlbGVjdEl0ZW1EaXJlY3RpdmUsIHNlbGVjdGVkSXRlbXM6IEFycmF5PGFueT4pIHtcbiAgICBsZXQgc3VjY2VzcyA9IGZhbHNlO1xuICAgIGNvbnN0IHZhbHVlID0gaXRlbSBpbnN0YW5jZW9mIFNlbGVjdEl0ZW1EaXJlY3RpdmUgPyBpdGVtLnZhbHVlIDogaXRlbTtcbiAgICBjb25zdCBpbmRleCA9IHNlbGVjdGVkSXRlbXMuaW5kZXhPZih2YWx1ZSk7XG5cbiAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgc3VjY2VzcyA9IHRydWU7XG4gICAgICBzZWxlY3RlZEl0ZW1zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB0aGlzLl9zZWxlY3RlZEl0ZW1zJC5uZXh0KHNlbGVjdGVkSXRlbXMpO1xuICAgICAgdGhpcy5pdGVtRGVzZWxlY3RlZC5lbWl0KGl0ZW0udmFsdWUpO1xuICAgIH1cblxuICAgIHJldHVybiBzdWNjZXNzO1xuICB9XG5cbiAgcHJpdmF0ZSBfdG9nZ2xlSXRlbShpdGVtOiBTZWxlY3RJdGVtRGlyZWN0aXZlKSB7XG4gICAgaWYgKGl0ZW0uc2VsZWN0ZWQpIHtcbiAgICAgIHRoaXMuX2Rlc2VsZWN0SXRlbShpdGVtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2VsZWN0SXRlbShpdGVtKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9zZWxlY3RJdGVtKGl0ZW06IFNlbGVjdEl0ZW1EaXJlY3RpdmUpIHtcbiAgICB0aGlzLnVwZGF0ZUl0ZW1zJC5uZXh0KHsgdHlwZTogVXBkYXRlQWN0aW9ucy5BZGQsIGl0ZW0gfSk7XG4gIH1cblxuICBwcml2YXRlIF9kZXNlbGVjdEl0ZW0oaXRlbTogU2VsZWN0SXRlbURpcmVjdGl2ZSkge1xuICAgIHRoaXMudXBkYXRlSXRlbXMkLm5leHQoeyB0eXBlOiBVcGRhdGVBY3Rpb25zLlJlbW92ZSwgaXRlbSB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX2hhc0l0ZW0oaXRlbTogU2VsZWN0SXRlbURpcmVjdGl2ZSwgc2VsZWN0ZWRJdGVtczogQXJyYXk8YW55Pikge1xuICAgIHJldHVybiBzZWxlY3RlZEl0ZW1zLmluY2x1ZGVzKGl0ZW0udmFsdWUpO1xuICB9XG59XG4iLCJpbXBvcnQgeyBEcmFnVG9TZWxlY3RDb25maWcgfSBmcm9tICcuL21vZGVscyc7XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX0NPTkZJRzogRHJhZ1RvU2VsZWN0Q29uZmlnID0ge1xuICBzZWxlY3RlZENsYXNzOiAnc2VsZWN0ZWQnLFxuICBzaG9ydGN1dHM6IHtcbiAgICBkaXNhYmxlU2VsZWN0aW9uOiAnYWx0JyxcbiAgICB0b2dnbGVTaW5nbGVJdGVtOiAnbWV0YScsXG4gICAgYWRkVG9TZWxlY3Rpb246ICdzaGlmdCcsXG4gICAgcmVtb3ZlRnJvbVNlbGVjdGlvbjogJ3NoaWZ0K21ldGEnXG4gIH1cbn07XG4iLCJpbXBvcnQgeyBOZ01vZHVsZSwgTW9kdWxlV2l0aFByb3ZpZGVycyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcblxuaW1wb3J0IHsgU2VsZWN0Q29udGFpbmVyQ29tcG9uZW50IH0gZnJvbSAnLi9zZWxlY3QtY29udGFpbmVyLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBTZWxlY3RJdGVtRGlyZWN0aXZlIH0gZnJvbSAnLi9zZWxlY3QtaXRlbS5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgU2hvcnRjdXRTZXJ2aWNlIH0gZnJvbSAnLi9zaG9ydGN1dC5zZXJ2aWNlJztcbmltcG9ydCB7IERyYWdUb1NlbGVjdENvbmZpZyB9IGZyb20gJy4vbW9kZWxzJztcbmltcG9ydCB7IENPTkZJRywgVVNFUl9DT05GSUcgfSBmcm9tICcuL3Rva2Vucyc7XG5pbXBvcnQgeyBERUZBVUxUX0NPTkZJRyB9IGZyb20gJy4vY29uZmlnJztcbmltcG9ydCB7IG1lcmdlRGVlcCB9IGZyb20gJy4vdXRpbHMnO1xuXG5jb25zdCBDT01QT05FTlRTID0gW1NlbGVjdENvbnRhaW5lckNvbXBvbmVudCwgU2VsZWN0SXRlbURpcmVjdGl2ZV07XG5cbmV4cG9ydCBmdW5jdGlvbiBDT05GSUdfRkFDVE9SWShjb25maWc6IFBhcnRpYWw8RHJhZ1RvU2VsZWN0Q29uZmlnPikge1xuICByZXR1cm4gbWVyZ2VEZWVwKERFRkFVTFRfQ09ORklHLCBjb25maWcpO1xufVxuXG5ATmdNb2R1bGUoe1xuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlXSxcbiAgZGVjbGFyYXRpb25zOiBbLi4uQ09NUE9ORU5UU10sXG4gIGV4cG9ydHM6IFsuLi5DT01QT05FTlRTXVxufSlcbmV4cG9ydCBjbGFzcyBEcmFnVG9TZWxlY3RNb2R1bGUge1xuICBzdGF0aWMgZm9yUm9vdChjb25maWc6IFBhcnRpYWw8RHJhZ1RvU2VsZWN0Q29uZmlnPiA9IHt9KTogTW9kdWxlV2l0aFByb3ZpZGVycyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5nTW9kdWxlOiBEcmFnVG9TZWxlY3RNb2R1bGUsXG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgU2hvcnRjdXRTZXJ2aWNlLFxuICAgICAgICB7IHByb3ZpZGU6IFVTRVJfQ09ORklHLCB1c2VWYWx1ZTogY29uZmlnIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBDT05GSUcsXG4gICAgICAgICAgdXNlRmFjdG9yeTogQ09ORklHX0ZBQ1RPUlksXG4gICAgICAgICAgZGVwczogW1VTRVJfQ09ORklHXVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInRzbGliXzEuX192YWx1ZXMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTtBQUdBLElBQWEsTUFBTSxHQUFHLElBQUksY0FBYyxDQUFxQix1QkFBdUIsQ0FBQzs7QUFDckYsSUFBYSxXQUFXLEdBQUcsSUFBSSxjQUFjLENBQXFCLGFBQWEsQ0FBQzs7Ozs7OztBQ0poRixJQUFhLFVBQVUsR0FBRyxFQUFFOztBQUM1QixJQUFhLFNBQVMsR0FBRyxDQUFDOztBQUMxQixJQUFhLFVBQVUsR0FBRyxDQUFDOztBQUMzQixJQUFhLGVBQWUsR0FBRyxlQUFlOzs7Ozs7QUNIOUM7QUFHQSxJQUFhLFFBQVEsR0FBRyxVQUFDLElBQVM7SUFDaEMsT0FBTyxJQUFJLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLEtB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